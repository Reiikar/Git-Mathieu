\documentclass[10pt]{article}

\usepackage{amsmath}
\usepackage{verbatim}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage[utf8]{inputenc}
\usepackage{pict2e}
\usepackage{tikz}
\usepackage{caption}
\usepackage[misc]{ifsym}

\usepackage[all]{xy}
\usepackage{graphicx}
\usepackage{geometry}
\geometry{hmargin=3cm,vmargin=1.5cm}

%-----Algorithms-----%
\usepackage[linesnumbered, ruled]{algorithm2e}
\newcommand{\inlcomment}[1]{\texttt{\small/* #1 */}}
\newcommand{\eolcomment}[1]{\hfill\texttt{\small// #1}}

%-----Theorems------%

\newtheorem{thm}{Theorem}
\newtheorem{prop1}[thm]{Proposition}
\newtheorem{coro1}[thm]{Corollary}
\newtheorem{lem1}[thm]{Lemma}
\newtheorem{appli}[thm]{Application}
\newtheorem{not1}[thm]{Notation}
\newtheorem*{abs}{Abstract}
\theoremstyle{definition}
\newtheorem{rq1}[thm]{Remark}
\theoremstyle{definition}
\newtheorem{expl}[thm]{Example}
\theoremstyle{definition}
\newtheorem{def1}[thm]{Definition}



%-----New commands-----%

\newcommand{\s}{\vspace{0.3cm}}
\newcommand{\cd}{\cdot}
\newcommand{\C}{\mathcal{C}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\D}{\Delta}
\newcommand{\calA}{\mathcal{A}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\aff}{\mathcal{A}_{\ff}}
\newcommand{\av}{\mathcal{O}}
\newcommand{\avp}{\mathcal{O'}}
\newcommand{\al}{\alpha}
\newcommand{\cw}{C_{\Omega}(D,G)}
\newcommand{\cg}{C_{\la}(D,G)}
\newcommand{\fqm}{\mathbb{F}_{q^m}}
\newcommand{\fqn}{\mathbb{F}_{q^n}}
\newcommand{\fq}{\mathbb{F}_q}
\newcommand{\fqd}{\mathbb{F}_{q^2}}
\newcommand{\fqo}{\mathbb{F}_{q_0}}
\newcommand{\fqr}{\mathbb{F}_{q^r}}
\newcommand{\w}{\omega}
\newcommand{\vp}{\nu_P}
\newcommand{\la}{\mathfrak{L}}
\newcommand{\pf}{\PP_F}
\newcommand{\pfp}{\PP_{F'}}
\newcommand{\cf}{\mathfrak{C}_F}
\newcommand{\df}{\mathfrak{D}_F}
\newcommand{\z}{z^{-1}}
\newcommand{\su}{\subseteq}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Y}{\mathcal{Y}}
\newcommand{\PR}{\mathcal{P}}
\newcommand{\QR}{\mathcal{Q}}
\newcommand{\h}{\mathcal{H}}
\newcommand{\pl}{\PP^1}
\newcommand{\co}{\mathcal{C}}
\newcommand{\coo}{\mathcal{D}}
\newcommand{\f}{\mathbb{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\Div}{\operatorname{Div}}
\newcommand{\Princ}{\operatorname{Princ}}
\newcommand{\Cl}{\operatorname{Cl}}
\newcommand{\Supp}{\operatorname{Supp}}
\newcommand{\Aut}{\operatorname{Aut}}
\newcommand{\Gal}{\operatorname{Gal}}
\newcommand{\ssag}{\operatorname{SSAG}}
\newcommand{\ag}{\operatorname{AG}}
\newcommand{\calL}{\mathcal{L}}

\newcommand{\hugues}[1]{\textcolor{blue}{#1}}
\newcommand{\notehugues}[1]{\marginpar{\small\hugues{#1}}}
\newcommand{\note}[1]{\textcolor{orange}{#1}}




%--------Title page-----%


\title{Structural attack on structured-SSAG-code-based McEliece cryptosystems}
\author{
Elise Barelli\\
Philippe Lebacque\footnote{Laboratoire de Mathématiques de Besançon, UMR 6623 CNRS, Université de Bourgogne Franche-Comté, France}\\
Mathieu Lhotel\footnote{Laboratoire de Mathématiques de Besançon, UMR 6623 CNRS, Université de Bourgogne Franche-Comté, France}\\
Hugues Randriam\footnote{ANSSI, Laboratoire de Cryptographie \& LTCI équipe C2, Télécom Paris}
}
\date{\today}        


%-----Beginnning of the document-------%


\begin{document}
\maketitle

\begin{abs} 
  In this paper, we study the security of variants of McEliece's cryptosystem, which are based on structured (\textit{e.g.} quasi-cyclic) subfield-subcodes of algebraic geometry codes (SSAG codes).
  More precisely, we show that the underlying secret structure of the public SSAG code can be recovered from that of its invariant subcode, which is also an SSAG code but with smaller parameters.
  
  After reviewing known attacks against this class of codes, we then finally propose a McEliece-like scheme based on quasi-cyclic SSAG Hermitian codes, together with a set of parameters that seem to resist these attacks.
\end{abs}

\newpage


\section{Introduction}


In the area of post-quantum cryptography, public-key cryptosystems using linear codes look promising. The first such system, based on binary classical Goppa codes, was introduced by McEliece in 1978 \cite{McE}. Its main drawback is that the size of the corresponding public key, \textit{i.e.} a generator matrix of the code, is too large for most practical use cases. Many propositions were made in order to correct this, mostly by considering codes with additional structure, \textit{e.g.} quasi-cyclic codes.
Indeed this makes the public key more compact, since in order to specify a generating matrix of the code, it then suffices to give its first row only.

\vspace*{0.2cm}

\noindent Moreover, replacing classical Goppa codes, defined over the projective line, by their natural generalization, defined on curves of higher genus, should also help in providing more flexibility. 
However, recent works from Couvreur, Marquez-Corbella and Pellikaan \cite{CMP} broke McEliece cryptosystems based on raw AG codes on arbitrary genus curves. So, in the same way that classical Goppa codes can be seen as subfield subcodes of GRS codes, this leads to more specifically consider subfield subcodes of AG codes ($\ssag$ in short), for which there are only few propositions to date. 

\vspace*{0.2cm}

\noindent The present work describes a structural attack on McEliece-like schemes based on structured SSAG codes.
The security of such a scheme relies on the fact that, given a random generator matrix of an SSAG code, it should be hard to recover the geometric data from which the code was defined, or more generally to find any geometric data giving an equivalent definition.
However, in our setting where we have an additional structure (\textit{e.g.} quasi-cyclicity), we show that the structural recovery of the public SSAG code reduces to that of its invariant subcode.
This invariant subcode is also an SSAG code, of which a generator matrix is easily derived from the public data, and it has smaller parameters.
As a consequence, the parameters of the scheme must be chosen carefully in order to keep this invariant SSAG subcode immune against structural recovery attacks.
This leads us to review known attacks of this sort, after which we can finally propose a scheme based on quasi-cyclic SSAG Hermitian codes, and provide a set of parameters that seem to secure the corresponding invariant code. 

\vspace*{0.2cm}

\noindent Besides structural recovery attacks, it is also interesting to discuss message recovery attacks.
Essentially the only approach for message recovery is via decoding algorithms for generic linear codes.
All these algorithms, most of which are variants of Prange's algorithm \cite{PR62}, have exponential complexity. Moreover they do not seem to benefit from the additional quasi-cyclic structure.
More precisely, given a received word, the additional structure provides other words with a same weight error, on which one could apply Sendrier's Decoding-One-Out-of-Many Algorithm \cite{DOOM}.
But ultimately this only gives a negligible advantage.
As a consequence, we see that although the structured SSAG code is equivalent to its invariant subcode from the point of view of structural recovery, then from the point of view of message recovery, it remains more secure.

\vspace*{0.2cm}

\noindent \textbf{Organization of the paper.}
In section 2, we give some classical notations and definitions that will be useful, both in algebraic geometry and coding theory. Section 3 is dedicated to the invariant code, with a focus on its geometric structure. In section 4, we present our attack in a general framework, while specific instances such as the Kummer and Artin-Schreier cases are given in section 5. General attacks against SSAG codes are discussed in section 6, such as the brute force search. We conclude with the proposition of a scheme based on SSAG Hermitian codes in section 7.

\vspace*{0.2cm}

\noindent\textbf{Genesis of this work.}
This work can be seen as an extension of Chapter~5 of the first author's PhD memoir \cite{Bar} and of her unpublished manuscript \cite{Bar2}.
The general method introduced in \cite{Bar} was slightly simplified, avoiding an unnecessary appeal to the dual code in the security reduction, and it was also widely generalized, making it work with arbitrary solvable coverings of curves.
On the other hand, the proposed scheme based on quasi-cyclic SSAG Hermitian code was left essentially unchanged.

\vspace*{0.2cm}

\noindent\textbf{Acknowledgements.}
The authors benefited from the support of ANR-21-CE39-0009 Barracuda.


\section{Notations and properties}


\subsection{Algebraic function fields}


Let $\fqm$ be the finite field with $q^m$ elements, were $q=p^s$ is a power of a prime $p$ and $m \geq 1$. A function field of one variable over $\fqm$ is a field $K$ with the property that there exists an element $x\in K$ such that $K/\fqm(x)$ is a finite separable extension. The following theorem makes the link between algebraic function fields and curves.

\begin{thm} [\cite{MOR}, Theorem 1.1]\label{lien curve-function field}
Let $K$ be a function field in one variable over $\fqm$, then there exist a smooth irreducible projective curve $\X$ whose function field $\fqm(\X)$ is isomorphic (as an extension of $\fqm$) to $K$. The converse is also true.
\end{thm}

Throughout this paper, all our curves will be \textit{smooth, irreducible} and \textit{projective}, and we will often make the analogy with their function field. 

\vspace*{0.2cm}

\noindent Let $\PP_K$ be the set of places of $K$. Any place $P \in \PP_K$ comes with its valuation ring $O_P$ and its discrete valuation $\nu_P : K \rightarrow \Z \cup \{\infty\}$ . The degree of the place $P$, denoted by $\deg(P)$, is defined as the  integer $\deg(P) :=  [O_P/P:\fqm] < \infty$.
The divisor group of $K$, denoted $\Div(K)$, is the free abelian group on $\mathbb{P}_K$ generated by the sums
\[A = \sum\limits_{P \in \Supp(A)} \nu_P(A) \cd P,\]
where $\Supp(A)$ is a finite subset of $\PP_K$, called the support of $A$, whose elements are places such that $\nu_{P}(A) \in \Z \backslash \{0\}$. \\ 
An element $P \in \Supp(A)$ is called a zero of $A$ if $\nu_P(A) >0$ (resp. a pole of $A$ if $\nu_P(A) < 0$). Given $z \in K$, we denote by $(z)^K$, $(z)^K_0$ and $(z)^K_{\infty}$ its assiciated divisor, divisor of its zeros and divisor of its poles respectively, meaning we have $(z)^K = (z)^K_0 - (z)^K_{\infty}$, where 
\[(z)^K_0 = \sum\limits_{\nu_P(A) > 0}\nu_P(A) \cd P \quad \textrm{and}  \quad (z)^K_{\infty} = \sum\limits_{\nu_P(A) < 0}-\nu_P(A) \cd P.\]
The degree of a divisor is naturally defined by the formula
\[\deg(A) = \sum\limits_{P \in \Supp(A)} \nu_P(A) \cd \deg( P).\]
We denote by $\Princ(K)$ the subgroup of $\Div(K)$ made of principal divisors and $\Div^0(K)$ the subgroup of degree zero divisors. The divisor class group of $K$ is defined by $\Cl(K):=\Div(K)/\Princ(K)$ and the group of divisor classes of degree zero by $\Cl^0(K):=\Div^0(K)/\Princ(K)$. 
Let $h(K):= \# \Cl^0(K)$ be the \emph{class number} of $K$. Then for any $r \geq 1$, the number of divisor classes in $\Cl(K)$ of degree $r$ does not depend on $r$, and is equal to $h(K)$. Finally, the Weil bound implies

\begin{thm}[see \cite{Tsf}, Proposition 3.1.23]\label{esti h(X)}
Let $K$ be an algebraic function field over $\fqm$ with genus $g(K)$. Then the class number $h(K)$ satisfies
\[ (\sqrt{q^m}-1)^{2g(K)} \leq h(K) \leq (\sqrt{q^m}+1)^{2g(K)}.\]
\end{thm}

Given a divisor $A \in \Div(K)$, its Riemann-Roch space is defined as the $\fqm$-vector space
\[\calL_K(A) = \{z \in K \ | \ (z)^L \geq -A\} \cup \{0\},\]
of dimension $\ell(A):= \dim_{\fqm}(\calL_K(A))$. If there is no ambiguity with the function field, we just write $\calL(A)$. \\
Given a tower $\fqm(x) \su K \su L$ of function fields over $\fqm$, let us consider a place  $P \in \PP_K$ and one of its extension $Q \in \PP_L$ (noted by $Q|P$). The ramification index is as usual denoted by $e(Q|P)$. \\
Let $\pi : \Y \rightarrow \X$ be a separable morphism between two curves $\X$ and $\Y$ over $\fqm$, whose function fields are given by $L := \fqm(\Y)$ and $K:=\fqm(\X)$. We define the pullback of $P \in \PP_K$ as the divisor
\[\pi^{*}P = \sum\limits_{Q|P} e(Q|P) \cd Q \in \Div(L).\]
Note that this definition extends to pullback of divisors by linearity. \\
Throughout the paper, we will make great use of the following lemma, which shows that pullbacks preserve the notion of principal divisors.

\begin{lem1} \label{tirarr}
Let $z \in L$ be a function. Then 
\[(z)^L = \pi^*(z)^K, \ (z)^L_0 = \pi^*(z)_0^K \ and \ (z)^L_{\infty} = \pi^*(z)^K_{\infty}.\]
\end{lem1} 

\begin{proof}
see \cite{Sti}, Proposition 3.1.9.
\end{proof}


\subsection{Coding theory}


As explained in the introduction, we will be dealing with SSAG codes, meaning that we start by defining AG codes over an extension $\fqm$ of $\fq$, where $q=p^s$ be a prime power, and $m \geq 1$ is an integer.

\begin{def1} \label{defagcode}
Let $\Y$ be a smooth irreducible projective curve over $\fqm$ with function field $L = \fqm(\Y)$, $\QR = \{Q_1,...,Q_n\}$ a set of $n$ distinct places of degree one in $L$  and $G \in \Div(L)$ a divisor such that $\Supp(G) \cap \QR = \emptyset$. Suppose that $\deg(G)<n$. Then the AG code associated to the triple $(\Y,\QR,G)$ is defined by
\[C_{\calL}(\Y,\QR,G) = \{ (f(Q_1),...,f(Q_n)) \ | \ f \in \calL(G)\} \su \fqm^n.\]
\end{def1}

\begin{def1}
With notations as above, we define the subfield subcode of $C_{\calL}(\Y,\QR,G)$ over $\fq$, denoted $\ssag_q(\Y,\QR,G)$, as follows
\[ \ssag_q(\Y,\QR,G) = C_{\calL}(\Y,\QR,G) \cap \fq^n.\]
\end{def1}

In particular, we will be interested in "structured" codes, which are codes with a non trivial permutation group. To be concrete, let $\Sigma \su \Aut(L)$ be a subgroup, and denote by $\mathrm{Orb}_{\Sigma}(Q)$ the orbit of $Q \in \PP_L$ under its action. If $\Sigma(\QR) = \QR$ and $\Sigma(G)=G$, then $\Sigma$ induces a permutation $\tilde{\Sigma}$ on the code $C_{\calL}(\Y,\QR,G)$. In order to satisfy this property, the support $\QR$ and the divisor $G$ will be constructed in the follwing way: $\QR$ will be a union, and $G$ a sum, of orbits under the action of $\Sigma$. With this satisfied, it is clear that they both are $\Sigma$-invariant since each orbit of places in $L$ is. Note that as a subfield subcode, the permutation $\tilde{\Sigma}$ also acts on code $\ssag_q(\Y,\QR,G)$.\\
Throughout the rest of the paper, we will only consider the case where $\Sigma$ is the Galois group of some extension of function fields $L/K$. We detail these settings in section~\ref{sectionfour}.


\begin{def1}
Let $\mathcal{C}$ be a $[n,k]$-linear code over a finite field $\fqm$. Its dual code is defined by 
\[\mathcal{C}^{\perp} := \{ y \in \fqm^n \ | \ xy^T = 0 \ , \ \forall \ x \in \mathcal{C}\}.\]
\end{def1}
It is easy to see that any generator matrix of $\mathcal{C}^{\perp}$ is a parity check matrix of $\mathcal{C}$. In particular, $\mathcal{C}^{\perp}$ is a $[n,n-k]$-code over $\fqm$.


\begin{prop1} \label{dual}
Let $C_{\calL}(\Y,\QR,G)$ be an $\mathrm{AG}$-code defined on a curve $\Y$. Then there exists a divisor $G' \in \Div(\Y)$ such that 
\[C_{\calL}(\Y,\QR,G)^{\perp} = C_{\calL}(\Y,\QR,G').\]
\end{prop1}

\begin{proof}
See \cite{Sti}, Proposition 2.2.10.
\end{proof}


\section{Invariant code}


\begin{def1} Given an $\ag$-code $\mathcal{C} = C_{\calL}(\Y,\QR,G)$ on a smooth irreducible projective curve $\Y$ with function field $L$, such that $\QR$ and $G$ are invariant under the action of $\Sigma \su \Aut(L)$, we define its invariant code as the subcode 
\[\mathcal{C}^{\Sigma} := \{c \in \mathcal{C} \ | \ \tilde{\Sigma}(c)=c\},\]
where $\tilde{\Sigma}$ is the permutation induced by $\Sigma$.
\end{def1}


Note that this code has repeated entries (\textit{ie.} all its words are equal on each orbit under $\Sigma$), so we usually use another one: the \emph{punctured invariant code}. It is denoted $\overline{\mathcal{C}}^{\Sigma}$, and is optained from $\C^{\Sigma}$ by keeping only one entry on each orbit of length $\#\Sigma$. Later on, we will use the punctered invariant code, but we will keep the notation $\mathcal{C}^{\Sigma}$. 

\begin{rq1}  \label{gen inv}
Suppose $\Sigma = \langle \sigma \rangle$ is cyclic of order $\ell$, and denote by $\sigma_{\mathcal{C}}$ the $\ell$-quasi-cyclic shift restricted to $\mathcal{C}$. Let also $I_{\ell} := \{1,...,n\}\backslash \{1,\ell+1,...,n-\ell+1\}$, where $n=\operatorname{Length}(\mathcal{C})$. Then the punctered invariant code can also be defined as
\[ \overline{\mathcal{C}}^{\Sigma} := \operatorname{Punct}_{I_{\ell}}(\mathcal{C}^{\Sigma}) = \operatorname{Punct}_{ I_{\ell}}(\ker (\sigma_{\mathcal{C}}-id)),\]

\noindent where for any linear code $\mathcal{C} \su \fqm^n$, $\mathrm{Punct}_I(\mathcal{C}):= \{(c_i)_{i \in \{1,...,n\}\backslash I} \ | \ \mathbf{c} \in \mathcal{C}\}$. 
As a consequence, it is possible to build in polynomial time in the parameters of $\mathcal{C}$, a generator matrix of the invariant code from the knowledge of a generator matrix of $\mathcal{C}$ and the induced permutation. 
\end{rq1}

In what follows, we study the structure of the invariant code, which will be a important result for the next parts. In particular, we show that this subcode is also an $\ag$-code, defined on the quotient curve $\Y/\Sigma$, whose function field is precisly the fixed field $K:=L^{\Sigma}$ of $L$. Let us start with the following lemma.

\begin{lem1} \label{inv}
Let $\QR$ and $G$ be as in Definition~$\ref{defagcode}$, and suppose that they are invariant under an automorphism $\sigma \in \Sigma \su \Aut(L)$. If $c = \operatorname{Ev}_{\QR}(g) \in C_{\calL}(\Y,\QR,G)$ is such that $\sigma(c) = c$, then $g$ is $\sigma$-invariant, ie. $g\circ \sigma = g$. 
\end{lem1}

\begin{proof}
Let us write $\QR = \{Q_1,...,Q_n\}$, and let $c=(g(Q_1),...,g(Q_n))$ be such that $\sigma(c)=c$. Then we have 
\begin{align*}
\forall \ i \in \{1,...,n\} \ , \ g(Q_{\sigma(i)}) = g(Q_i) &\iff \forall \ i \in \{1,...,n\} \ , \ (g \circ \sigma)(Q_i) =g(Q_i) \\
& \iff \forall \ i \in \{1,...,n\} \ , \ (g\circ \sigma - g)(Q_i) = 0.
\end{align*}
Since the divisor $G$ is $\sigma$-invariant, we have $g \circ \sigma \in \calL(G)$, and thus $g\circ \sigma - g \in \calL(G)$ also.
However the equivalence above gives $n>\deg(G)$ zeroes to this function. This implies $(g \circ \sigma - g) \equiv 0$.
\end{proof}

\begin{def1} \label{pousseavant}
Consider an extension $L/K$ of function fields and $G \in \Div(L)$. We denote by $\tilde{G} \in \Div(K)$ the largest divisor (according to the degree) such that
\[\pi^*\tilde{G} \leq G.\]
\end{def1} 
 
\begin{rq1} \label{jsp}
If $A \in \Div(K)$, we have 
\[\widetilde{\pi^*A}=A.\]
\end{rq1}

\begin{prop1} \label{invrr}
Let $L/K$ be a function field extension and $\sigma \in \Aut(L)$ an automorphism. Let also $G \in \Div(L)$ be a $\sigma$-invariant divisor, \textit{ie.} there exists $s \in \N^*$ and places $S_1,...,S_s \in \PP_L$ such that 
\[G = \sum\limits_{i=1}^s t_i \sum\limits_{S \in \mathrm{Orb}_{\sigma}(S_i)} S,\]
for some $t_i \in \Z \backslash \{0\}$. Then
\begin{itemize}
\item[(i)] The divisor $\tilde{G}$ associated to $G$ (see Definition~\ref{pousseavant}) is given by
\[\tilde{G}:= \sum\limits_{i=1}^s \left\lfloor\dfrac{t_i}{e(S_i|R_i)}\right\rfloor  R_i \in \Div(K),\]
where $S_i|R_i$ for all $1 \leq i \leq s$;
\item[(ii)]  $\calL_L(G)^{\sigma} = \calL_K(\tilde{G})$.
\end{itemize}
\end{prop1}

\begin{proof}
\begin{itemize}
\item[$(i)$] By definition of the pullback of a divisor, we have
\[\pi^*\tilde{G} = \sum\limits_{i=1}^s e(S_i|R_i) \cd \left\lfloor\dfrac{t_i}{e(S_i|R_i)}\right\rfloor \sum\limits_{S \in \mathrm{Orb}_{\sigma}(S_i)} S \leq G,\]
which gives the result. 
\item[$(ii)$] Let $g \in \calL_L(G) \su L$ be such that $g \circ \sigma = g$ (\textit{ie.} $g \in \calL_L(G)^{\sigma} \su L^{\sigma}=K$). For each $i \in \{1,...,s\}$, consider a place $R_i \in \PP_{L^{\sigma}}$ such that $S_i|R_i$. It is well known that for every $S \in \mathrm{Orb}_{\sigma}(S_i)$, we also have $S|R_i$ and $e(S|R_i)=e(S_i|R_i)$. Since $g \in \calL_L(G)$, we know by definition that
\[(g)_L \geq -G=- \sum\limits_{i=1}^s t_i \sum\limits_{S \in \mathrm{Orb}_{\sigma}(S_i)} S\]
Note that for every $i \in \{1,...,s\}$, we have $e(S_i|R_i) \cd \nu_{R_i}(g) = \nu_{S_i}(g)$, thus
\[(g)_{L^{\sigma}} \geq - \sum\limits_{i=1}^s \dfrac{t_i}{e(S_i|R_i)}  R_i \geq - \tilde{G},\]
which implies $g \in \calL_K(\tilde{G}) \su L^{\sigma}$. Hence $\calL_L(G)^{\sigma} \su \calL_K(\tilde{G})$. \\
Conversly, let $g \in L^{\sigma}$ such that $g \in \calL_K(\tilde{G})$, with $\tilde{G}$ defined as above. We have 
\[ (g)_L = \pi^*(g)_{L^{\sigma}} \geq -\sum\limits_{i=1}^s e(S_i|R_i) \cd \left\lfloor\dfrac{t_i}{e(S_i|R_i)}\right\rfloor \sum\limits_{S \in \mathrm{Orb}_{\sigma}(S_i)} S \geq -G,\]
and thus $g \in \calL_L(G) \cap L^{\sigma} = \calL_L(G)^{\sigma}$.
\end{itemize}
\end{proof}
\color{black}

\begin{thm} [Structure of the invariant code] \label{invstruct}
Let $\mathcal{C} := C_{\calL}(\Y,\QR,G)$ be an $\mathrm{AG}$-code defined on a curve $\Y$ with function field $L$, invariant under the action of $\Sigma \su \Aut(L)$. Then its invariant code is also an $\mathrm{AG}$-code, defined on the quotient curve $\Y/\Sigma$. In particular, there exist a support $\PR$ and a divisor $\tilde{G}$ on $\Y/\Sigma$ such that
\[\mathcal{C}^{\Sigma} = C_{\calL}(\Y/\Sigma,\PR,\tilde{G}).\]
\end{thm}

\begin{proof}
Straightforward consequence of Lemma~\ref{inv} and Proposition~\ref{invrr}.
\end{proof}

\begin{rq1} \label{rqq}
The above theorem can be precised, since we can make $\PR$ and $\tilde{G}$ explicit. Indeed, $\tilde{G}$ corresponds to the divisor introduced in Proposition~\ref{invrr} $(ii)$, and \[\PR := \\ \{P \in \PP_{L^{\Sigma}} \ ; \ Q|P\} = \{Q \cap L^{\Sigma} \ , Q \in \QR\} \] In particular, they can be described by using the ramification in the cover of curves $\Y \longrightarrow \Y/\Sigma$.
\end{rq1}

\begin{rq1} \label{commute}
Let $\mathcal{C}$ be an AG code on a curve $\Y$ with function field $L$, invariant under $\Sigma \su \Aut(L)$, then
\[(\mathcal{C}\cap \fq^n)^{\Sigma} = \{c \in \mathcal{C} \ | \ c \in \fq^n \ \textrm{and} \ \sigma(c)=c \ , \ \forall \sigma \in \Sigma\} = \mathcal{C}^{\Sigma} \cap \fq^n,\]
that is invariant and subfield subcode operations commute.
\end{rq1}

\begin{coro1} \label{ssag}
With the notations of Theorem~\ref{invstruct}, we have
\[\ssag_q(\Y,\QR,G)^{\Sigma} = \ssag_q(\Y/\Sigma,\PR,\tilde{G}),\]
where $\PR$ and $\tilde{G}$ are given in Remark $\ref{rqq}$.
\end{coro1}

\begin{proof}
Immediate consequence of Theorem~\ref{invstruct} and Remark~\ref{commute}.
\end{proof}


\section{Recovering the equation of a Galois cover} \label{sectionfour}


Throughout all this section, we work in the finite field $\fqm$, with $m \geq 1$ and $q=p^s$ a prime power. Let us consider a Galois cover 
\[\pi : \Y \longrightarrow \X\]
between smooth, irreducible and projective curves defined over $\fqm$. It corresponds to a Galois extension of function fields $K \su L$,
where $K=\fqm(\X)$ and $L=\fqm(\Y)$. In particular, there exists a primitive element $y \in L$ such that $L=K(y)$ and
\[ H(y)=0 \ , \ H \in K[T] \ \mathrm{irreducible \ polynomial.}\]
In order to recover an equation of $\Y$, we need to find the minimal polynomial $H$ of $y$ over $K$. Denote by $\ell=[L:K]$ the degree of the extension $L/K$ (\textit{ie.} the order of its Galois group) and suppose that we are given a set of $r$ places of degree one in $K$, say $\PR = \{P_1,...,P_r\}$, that totally split in $L/K$. For any $1 \leq i \leq r$, we then have
\[\pi^*P_i = Q_{i,1} + ... + Q_{i,\ell},\]
where $Q_{i,j}|P_i$. In particular, it means that for all $1\leq i\leq r$, we have 
\[\mathrm{Orb}_{\Gal(L/K)}(Q_{i,1})=\{Q_{i,1} + ... + Q_{i,\ell}\}.\]
Denote by $\QR = \{Q_{i,j} \ | \ 1 \leq i \leq r \ \mathrm{and} \ 1 \leq j \leq \ell\}$ the set of all extensions of the $P_i$'s in $L$. Note that the set $\QR$ is an ordered set, which in general is not ordered by orbits of length $\ell$ (we will sometimes make this assumption later to simplify the computations). \\
Let $G \in \Div(L)$ be an invariant divisor as in Proposition~\ref{invrr}, such that $\Supp(G) \cap \QR = \emptyset$ and \\ $\deg(G)<n:=\ell r$. Also, we denote by $\tilde{G} \in \Div(K)$ the corresponding divisor given by Proposition~\ref{invrr}, $(i)$, which satisfies $\Supp(\tilde{G}) \cap \PR = \emptyset$. 

\begin{rq1} 
The situation above can be described in terms of AG codes. In fact, it is clear from the construction that both the support $\QR$ and the divisor $G$ are invariant under the action of $\Sigma$, which then induces a permutation on the AG code $C_{\calL}(\Y,\QR,G)$, whose invariant code is then given by $C_{\calL}(\X,\PR,\tilde{G})$. 
\end{rq1}

Before describing our method to recover an equation of $\Y$, let us put together our assumptions:

\begin{enumerate}
\item We know a parity check matrix $\mathbf{H}$ of the SSAG code  \[\mathcal{C} := \ssag_q(\Y,\QR,G);\]
\item We have full knowledge of the invariant code $\C^{\Sigma}$: more precisly, we know the quotient curve $\X$ (and thus its function field $K$), the finite set of places $\PR$ of $K$ and the divisor $\tilde{G} \in \Div(K)$;
\item We have some information about the action of $\Gal(L/K)$ on the unkown support $\QR$. In particular, for any known place $P \in \PR$, we know the positions of its $\ell$ extensions in the ordered set $\QR$;
\item We have \emph{enough information} on the pole divisor of $y$, where $y \in L$ is such that $L=K(y)$. This assumption will be discussed later, since the key point will be to control the divisor 
\[\widetilde{(y)^L_{\infty}} \in \Div(K).\] 
\end{enumerate}

Let us now explain what we plan to do. The main idea is first to recover the finite set of points $\QR$ in $\Y$, in order to recover the minimal polynomial of $y$ using interpolation. Thanks to hypothesis $2$, we know the coordinates of the rational points corresponding to the places $P_i$'s in $K$. Since places in $\QR$ are extensions of places in $\PR$ (\textit{ie.} for all $Q \in \mathcal{Q}$, there exist $P \in \PR$ such that $P=Q\cap K$), we only need to recover the $y$-evaluation of points in $\QR$. Thus, we are led to find the row vector
\begin{equation}
\textbf{y} = (y_{i,j})_{i,j},
\end{equation}
where $y_{i,j} := y(Q_{i,j})$, for every $1 \leq i \leq r$ and $1 \leq j \leq \ell$.
For this purpose, we construst a linear system of which it is solution: recall that by definition, the parity check matrix of the code $\mathcal{C}=\ssag_q(\Y,\QR,G)$ satisfies
\begin{equation} \label{two}
\mathbf{c} \in \mathcal{C} \iff \mathbf{Hc}^T = 0.
\end{equation}
Moreover, we know that a codeword $\mathbf{c} \in \mathcal{C}$ comes from evaluation of functions in the Riemann-Roch space of $G$. In particular, given $\mathbf{c} \in \C$ there exists a function $f \in \calL_L(G)$ such that  
\[\mathbf{c} = (f(Q_{i,j}))_{i,j}.\]
Of course, $\calL_L(G)$ is unknown since the divisor $G$ is as well. But we actually do not need the whole space $\calL_L(G)$ to recover $\mathbf{y}$. In fact, we are searching for a subspace $\mathcal{L} \su \calL_L(G)$, big enough (we will explain it later), and made of functions that specifically have the form $g \cd y$, where $g \in K$ and $y$ is such that $L=K(y)$. Once such a space is found, we have 
\[\{\mathbf{c}= (g(Q_{i,j}) \cd y(Q_{i,j})) \ , \ 1 \leq i \leq r \ , \ 1 \leq j \leq \ell \ \textrm{and} \ g\cd y \in \mathcal{L}\} \cap \fq^n \su \mathcal{C}.\] 
In particular, since $g \in K$, the numbers $g(Q_{i,j})$ are known for all $i,j$ ($g$ does not depend on $y$), the right-hand side of \eqref{two} gives a system of linear equations where everything is known exept for the $y(Q_{i,j})$. \\
Since we know the quotient curve (\textit{ie.} its function field $K$) as well as the morphism $\pi : \Y \rightarrow \X$, we construct the space $\mathcal{L}$ as a set of pullbacks of functions in $K$. To be concrete, we are searching for a space of functions $\mathcal{F} \su K$, as big as possible, such that for all $f \in \mathcal{F}$, we have
\begin{equation} \label{three}
(\pi^*f) \cd y \in \calL_L(G). 
\end{equation}

The following lemma shows that a good choice is to consider a Riemann-Roch space of a specific divisor $D \in \Div(K)$.   

\begin{lem1} \label{constructionD} Let $D := \widetilde{G}-\widetilde{(y)^L_{\infty}} \in \Div(K)$. Then we have
\[\mathcal{F} := \calL_K(D) \su \calL_K(\tilde{G});\]
and $\mathcal{F}$ satisfies condition~\eqref{three} above.
\end{lem1}


\begin{proof}
The inclusion $\mathcal{F} \su \calL_K(\tilde{G})$ easyly follows from the fact that $\widetilde{(y)^L_{\infty}}$ is a positive divisor, and thus $\tilde{G}-\widetilde{(y)^L_{\infty}} \leq \tilde{G}$. Next we show that $(3)$ holds. Fix $f \in \mathcal{F} :=  \calL_K\left(\tilde{G}-\widetilde{(y)^L_{\infty}}\right)$. By definition, we have
\[(f)^K \geq -\left(\tilde{G}-\widetilde{(y)^L_{\infty}}\right),\]
and then

\[(\pi^*f)^L = \pi^*((f)^K) \geq -\pi^*\left(\tilde{G}-\widetilde{(y)^L_{\infty}}\right) \geq (y)^L_{\infty} - G.\]
Now, we get 
\[((\pi^*f) \cd y)^L = (\pi^*f)^L  + (y)^L \geq  ((y)^L_{\infty} - G)+(y)^L = (y)^L_0 - G \geq -G,\]
since $(y)^L_0$ is an effective divisor. In particular, we just proved that $(\pi^*f) \cd y \in \calL_L(G)$ for every $f \in \mathcal{F}$, which is exactly \eqref{three}.
\end{proof}

\begin{rq1}  \label{remark5}
From our assumptions, the space of functions $\mathcal{F}$ given in the above lemma is the best we can construct since we do not have any information on the structure of $\calL_L(G)$. Note however that from Definition~\ref{pousseavant} and the proof of Lemma~\ref{constructionD}, our choice is not far from being optimal.  
\end{rq1}

In our situation, the space $\mathcal{F}$ in Lemma~\ref{constructionD} can be explicitely determined, since it is a subspace of $K$ which is supposed to be known (see hypothesis 2 and 4 above). Thus, suppose the divisor 
\begin{equation} \label{four}
D := \tilde{G} - \widetilde{(y)^L_{\infty}} \in \Div(K)
\end{equation}
is known from now on. In particular, we can find a basis $f_1,...,f_s \in K$ of its Riemann-Roch space, meaning that $\mathcal{F}$ is given by
\[\mathcal{F} := \calL_K(D) = \langle f_1,...,f_s \rangle_{\fqm},\]
where $s := \dim(D)$. \\
Now let us consider the row vectors, for every $1 \leq k \leq s$ :
\begin{center}
$\mathbf{u}_{k}:= \left(\pi^*f_k(Q_{i,j})\right)_{i,j}$ , with $1 \leq i \leq r \ , \ 1 \leq j \leq \ell$.
\end{center}

At this point, we are able to compute the $\mathbf{u}_{k}$'s in the following way :
\begin{enumerate}
\item We first compute the vectors \textbf{a}$_{k} := (f_k(P_i))_i$ , $1 \leq i \leq r$, which can be easily done since both the $f_k$'s and $P_i$'s are known by this point;
\item Next we use hypothesis $3$ to recover the \textbf{u}$_{k}$'s: by definition of pullbacks, for any fixed $1 \leq i \leq r$, we have 
\[f_k(P_i) = \pi^*f_k(Q_{i,j}) \ , \ 1 \leq j \leq \ell.\]
Since we know the indices (in the ordered set $\QR$) corresponding to the extensions in $\PP_L$ of any place $P \in \PR$, we can re-build the $\mathbf{u}_{k}$'s by duplicating the value of $f_k(P_i)$ in the corresponding coordinates.
\end{enumerate}

Using~\eqref{two} and~\eqref{three}, one gets 
\begin{center}
\textbf{u}$_{k}$ $\star$ \textbf{y} $\in \mathcal{C}$, for every $1 \leq k \leq s,$ 
\end{center}
where $\star$ is the componentwise product of row vectors.
If we denote by \textbf{D}$_{k} = $ Diag(\textbf{u}$_{k}$), the right hand-side of \eqref{two} leads to the linear system 
\begin{equation} \label{system}
\begin{pmatrix}
\mathbf{H} \cd \textbf{D}_1 \\
\vdots \\
\mathbf{H} \cd \textbf{D}_s
\end{pmatrix}
\cd \textbf{y}^T = 0, 
\end{equation}
from which \textbf{y} is a particular solution.
Then if we have enough equations, we can hope to recover \textbf{y} by solving \eqref{system}. 

Let us denote by
\begin{center}
$\mathbf{A} := \begin{pmatrix}
\mathbf{H} \cd \mathbf{D}_1 \\
\vdots \\
\mathbf{H} \cd \mathbf{D}_s
\end{pmatrix}
$
\end{center}
the above matrix. By the above discussion, $\mathbf{y}$ is in the kernel of $\mathbf{A}$, but since it is the only vector we are searching for, we have to study a bit more the vector space $\mathrm{Ker}(\mathbf{A})$. In order this space to have dimension one (meaning that $\mathbf{y}$ is the unique solution up to scalar multiplication), we would like to have as many equations as possible. In the discussion below, we study how the parameters impact the structure of $\mathrm{Ker}(\mathbf{A})$.
If $S$ denotes the number of equations in the linear system \eqref{system}, we have 
\[S = \#\operatorname{Rows}(\mathbf{H}) \times s,\]
where $s := \ell( D)$. By definition, the number of rows of $\mathbf{H}$ equals $n-\dim_{\fq}(\mathcal{C})$. Using Delsarte's theorem, we have
\[\dim_{\fq}(\mathcal{C}) \geq n-m\dim_{\fq}(C_{\mathcal{L}}(\Y,\QR,G)),\]
so applying twice the Riemann-Roch theorem show that the number of equations in~\eqref{system} is closely related to the degree of $G$ (since $\deg(\tilde{G}) \leq \lfloor \frac{\deg(G)}{\ell} \rfloor$) and both genera of $L$ and $K$, provided that the code length is fixed. \\
Nevertheless, in all our computing experiments, we noticed that thes do not impact the structure of $\mathrm{Ker}(\mathbf{A})$ and thus the solutions of \eqref{system}. The upcoming Proposition tells us that it is not really surprising: in fact, it is possible to describe other solutions independently of theses parameters.
\color{black}


\begin{prop1} \label{othersolutions}
Let $h \in L$ be a function such that 
\[ (h)^L_{\infty} \leq (y)^L_{\infty}.\]
 Then the evaluation vector $\mathbf{h}  := (h_{i,j})_{i,j}$ ,where $h_{i,j} := h(Q_{i,j})$, for every $1 \leq i \leq r$ and $1 \leq j \leq \ell$ is also in the kernel of $\mathbf{A}$.
\end{prop1}

\begin{proof}
Using notations of Lemma~\ref{constructionD}, take $h \in L$ as above and $g \in \mathcal{F}$. By definition, we have 
\[(\pi^*g)^L \geq -\pi^*\left(\tilde{G}-\widetilde{(y)^L_{\infty}}\right) \geq - G + (y)^L_{\infty}.\]
Thus, 
\[((\pi^*g) \cd h)^L = (\pi^*g)^L  + (h)^L \geq -G + (y)^L_{\infty}+(h)^L = -G + (h)^L_0 + \underbrace{((y)^L_{\infty}-(h)^L_{\infty})}_{\geq 0} \geq -G,\]
which proves $(\pi^*\mathcal{F})\cd h \su \calL_L(G)$ and conclude the proof.
\end{proof}

The above proposition proves that the space of solutions doesn't depend on the number of equations. 
We will see in some examples later that we can explicitely decide whenever a function gives a solution or not, depending on the divisor $(y)^L_{\infty}$. This leads to a problem: how to find $\mathbf{y}$ among all possible solutions? We will see in practical examples later that depending on the cover, and especially on the action of the automorphism group $\Sigma$,  we can add other equations to~\eqref{system} that are only satisfied by $\mathbf{y}$, allowing us to separate it from other solutions.

\section{Applications}


\subsection{About the quotient curve}

As we saw in section~\ref{sectionfour}, our method allows us to recover a defining equation of a smooth irreducible projective curve $\Y$, provided that we are given enough information about one of its quotient curves $\X$. We can wonder for which kind of curve $\X$ we can apply the attack described in section~\ref{sectionfour}: a first idea could be to take $\X$ equals to the projective line $\PP^1$ over $\fqm$.
In this situation, the AG code we are looking for is a Generalized Reed-Solomon code (GRS in short). As the dual of a GRS-code is also a GRS-code, the corresponding invariant SSAG code turns out to be an alternant code. Note that is easy to pass from the description of an SSAG code over $\PP^1$ to a description of an alternant code (see~\cite{Sti}, Chapter 2). \\
In~\cite{FOP2}, the authors proposed a new method to break cryptographic schemes based on alternant codes, called \emph{algebraic attacks}. In particular, they show that the secret structure of these codes satisfy a system of polynomial equations (we give more explanations in section~\ref{bruteforce}). Despite the fact that the cost of solving such systems might be hard to estimate, it seems reasonable to consider a more general class of curves for the choice of $\X$ in order to protect future schemes from this attack.


From hypothesis $4$ (see section~\ref{sectionfour}), we would like to control the divisor $\widetilde{(y)}^L_{\infty}$, where $y$ is a primitive element of $L/K$. It is clear that if $K=\PP^1$, this divisor is only support by the extension of the point at infinity $\infty$ in the projective line. 



\begin{def1} \label{courbes a variables separees}
Let $K$ be a function field of one variable over $\fqm$. We say it has separated variables if there exist two functions $x,\alpha$ such that $K=\fqm(x,\alpha)$, with
\[F_1(\alpha) = F_2(x),\]
where $F_1,F_2 \in \fqm[T]$ and $[K:\fqm(x)] = \deg({F_1})$.
Naturally, we say that a smooth irreducible projective curve $\X$ over $\fqm$ has separated variables if its function field $\fqm(\X)$ has separated variables.
\end{def1}

Notice that the above definition hightly rely on the choice of $x$ and $\alpha$. The following lemma explains why these curves are interesting in our case.

\begin{lem1} \label{lemdegre}
Let $\X$ be a curve with separated variables, whose function field $K=\fqm(x,\alpha)$ is given by the equation
\[F_1(\alpha) = F_2(x),\]
where $F_1,F_2 \in \fqm[T]$ are two univariate polynomials with coprime degrees, and denote by $\pi : \X \longrightarrow \PP^1$  the corresponding morphism of curves. If $\infty$ is the pole of $x$ in $\fqm(x)$, then it totally ramifies in $K/\fqm(x)$, and its extension $P_{\infty} \in K$ is the unique pole of $\alpha \in \PP_K$. Moreover, we have 
\[(\alpha)^K_{\infty} = \deg{(F_2) \cd P_{\infty}}.\]
\end{lem1}

\begin{proof}
Let $P_{\infty}$ be some extension of $\infty$ in $K$. Obviously, we have
\[e(P_{\infty}|\infty) \leq \deg(F_1)=[K:\fqm(x)].\]
On the other side, from the defining equation of $K$, we get
\[F_1(\alpha) = F_2(x) \Rightarrow \deg(F_1) \cd \nu_{P_{\infty}}(\alpha) = e(P_{\infty}|\infty) \cd \deg(F_2) \cd \underbrace{\nu_{R_{\infty}}(x)}_{=-1}.\]
Since $\gcd(\deg(F_1),\deg( F_2))=1$, we get $\deg(F_1)|e(P_{\infty}|\infty)$, and thus $e(P_{\infty}|\infty)=\deg(F_1)$. Moreover, we have 
\begin{align*}
\deg(F_1) \cd (\alpha)^K_{\infty} &= \deg(F_2) \cd \pi^*(x)^{\fq(x)}_{\infty} \\
&= \deg(F_2) \cd \pi^*\infty \\
&= \deg(F_2) \cd e(P_{\infty}|\infty) \cd P_{\infty},
\end{align*}
which gives the result.
\end{proof}

The main point in this type of curves is that we keep track of the place at infinity (namely $\infty$) in the corresponding extension of function fields. This will later allows us to look at the ramification of $\infty$ in the tower $\fqm(x) \su K \su L$, giving us a good way to describe the divisor $\widetilde{(y)_{\infty}^L} \in \Div(K)$.


\subsection{Kummer covering} \label{sectionkummer}


Let $\X$ be a curve over $\fqm$ with separated variables (see. Definition~\ref{courbes a variables separees}), whose function field is given by $K=\fqm(x,\alpha)$, with
\[F_1(\alpha) = F_2(x),\] 
such that $F_1,F_2 \in \fqm[T]$ and $\gcd(\deg(F_1),\deg(F_2))=1$. 

Let $\ell \mid q^m-1$ be an integer (not necessarly a prime), and consider the extension $L=K(y)$, with
\begin{equation} \label{kummer}
y^{\ell} = f(x,\alpha) \ , \ f \in \fqm[X,T]. 
\end{equation}
Set $d:=\deg\left((f)^L_{\infty}\right)$, and suppose also that $\gcd(d,\ell)=1$. Then $L/K$ is a Kummer extension (see~\cite{Sti} Annex A.13), cyclic of order $\ell=[L:K]$ and 
\[\Gal(L/K) = \{ \sigma : y \mapsto \xi \cd y \ | \ \xi \in \mu^*_{\ell}(\fqm)\}.\] 

\begin{rq1} \label{pk des polynomes}
This special case of cyclic extensions have been extensively studied and are well-known. With Artin-Schreier extensions, they caracterize in a sense all cyclic extensions (see \cite{Sti} Annex A.13). In particular, the element $f$ in \eqref{kummer} should be an element in $K$, that is potentially a rational function. Above, we supposed that $f$ is a polynomial, since we can always reduce to this case using a change of variables.
\end{rq1}

Let us explain the hypotheses given in section~\ref{sectionfour}) in this famework. Denote by $\pi : \Y \longrightarrow \X$ a morphism of algebraic curves that corresponds to a Kummer extension of function fields $L/K$. Suppose we are given an $\ssag$ code $\mathcal{C}$ on $\Y$, that is invariant under the action of $\Gal(L/K)$. This group being well-known, the corresponding action is completely determined by the choice of an $\ell^{th}$-root of unity $\xi \in \mu^*_{\ell}(\fqm)$. Our hypotheses are then the following:

\begin{enumerate}
\item We know a parity check matrix $\mathbf{H}$ of the code $\mathcal{C} = \ssag_q(\Y,\QR,G)$;
\item The quotient curve $\X$ is known (and thus both polynomials $F_1$ and $F_2$), as well as the structure of the invariant code of $\mathcal{C}$, \textit{ie.} $\PR$ and $\tilde{G}$ such that $\mathcal{C}^{\sigma} = \ssag_q(\X,\PR,\tilde{G})$;
\item We know how the automorphism $\sigma \in \Gal(L/K)$ permutes the support $\QR$, but we do not know the primitive root of unity $\xi$ that defines it.
\end{enumerate}

As for the last hypothese, we need to control the divisor $\widetilde{(y)^L_{\infty}}$, which is the point of the upcoming results: 

\begin{lem1} \label{ramification}
Keep notations as in Lemma~\ref{lemdegre} and denote by $P_{\infty}$ the unique pole of $\alpha$ in $K$. Then $P_{\infty}$ is totally ramified in $L/K$ and its extension $Q_{\infty} \in L$ is the unique pole of $y$ in $L$. 
\end{lem1}

\begin{proof}
See \cite{Sti}, Proposition 3.7.3.
\end{proof}

\begin{prop1} \label{propcle}
We have
\[(x)^L_{\infty} = \ell \cd \deg(F_1) \cd Q_{\infty},\]
\[(\alpha)^L_{\infty} = \ell \cd \deg(F_2) \cd Q_{\infty},\]
and
\[(y)^L_{\infty} = d \cd Q_{\infty}.\]
\end{prop1}

\begin{proof}
Let $\infty$ be the simple pole of $x$ in $\fqm(x)$. It is totally ramified in $K/\fqm(x)$ (see Lemma~\ref{lemdegre}), so $(x)^K = \deg(F_1) \cd P_{\infty}$. We also know the divisor of poles of $\alpha$ in $K$, so using Lemma~\ref{tirarr} yields
\[(x)^L_{\infty} = \pi^*(x)^K_{\infty} = \deg(F_1) \cd \pi^*P_{\infty} = \ell \cd \deg(F_1) \cd Q_{\infty},\]
and
\[(\alpha)^L_{\infty} = \deg(F_2) \cd \pi^*P_{\infty} = \ell \cd \deg(F_2) \cd Q_{\infty}.\]
Next, by hypothesis we have $(f)^K_{\infty} = d \cd P_{\infty}$ (recall that $P_{\infty}$ is the unique pole of $x$ and $\alpha$ and $K$), so the equation $y^n=f$ gives
\begin{align*} \ell \cd (y)^L_{\infty} &= \pi^*(f)^K_{\infty} \\
&= d \cd e(Q_{\infty}|P_{\infty}) \cd Q_{\infty}.
\end{align*}
\end{proof}

\begin{rq1} The pole divisor of $y$ we are interested in is particularly simple here because it is only supported by one place, which is the unique extension of the point at infinity $\infty$ in the tower $\fqm(x) \su K \su L$.
\end{rq1}

Proposition~\ref{propcle} above allows us to give the precise structure of the divisor $D$ defined in \eqref{four}, section 4.

\begin{coro1} \label{diviseurDKummer}
We have
\[D = \tilde{G} - \left\lceil\frac{d}{\ell}\right\rceil \cd P_{\infty} \in \Div(K).\]
\end{coro1}

\begin{proof}
From the structure of $(y)^L_{\infty}$ given in Proposition~\ref{propcle}, it is clear that 
\[\Supp\left(\widetilde{(y)^L_{\infty}}\right) \su \{P_{\infty}\},\]
since $Q_{\infty}$ is fully ramified. 
It remains to show that if $D$ is defined as above, then $D = \tilde{G} - \widetilde{(y)^L_{\infty}}$. In fact, we have
\begin{align*}
\pi^*D &= \pi^* \left(\tilde{G} - \left\lceil\frac{d}{\ell}\right\rceil \cd P_{\infty}\right) \\
&\leq G - \ell \cd \left\lceil\frac{d}{\ell}\right\rceil \cd Q_{\infty} \ \quad (\textrm{since} \ \pi^*P_{\infty} = \ell \cd Q_{\infty})\\
& \leq G - d \cd Q_{\infty} \\
&= G-(y)^L_{\infty},
\end{align*}
the last equality coming from Proposition~\ref{propcle}. 
\end{proof}

Note that the divisor $D$ in the above corollary is known in this context from our hypotheses, and thus we can construct the corresponding linear system~\eqref{system}.

As we already mentionned earlier,~\eqref{system} does not only have the vector \textbf{y} as solution, but also any evaluation vector that comes from a function $h \in L$ such that 
\[(h)^L_{\infty} \leq (y)^L_{\infty} = d \cd Q_{\infty}.\]
In the context of a Kummer covering, we can easily find other solutions. In fact, let $h := x^i\alpha^j \in K$ be a function that only depend on variables $x$ and $\alpha$, and denote by $\mathbf{h} := \textbf{x}^i\boldsymbol{\alpha}^j$ its corresponding evaluation vector (at the places in $\QR$). Using Proposition~\ref{propcle}, and in particular the description of the pole divisors of $x$ and $\alpha$, we see that 
\[ (h)^L_{\infty} = \ell \left(i  \deg(F_1)+j \deg(F_{\rm 2})\right) \cd Q_{\infty}.\]
As a result, $\mathbf{h}$ is also a solution of the system~\eqref{system}, provided that
\[\ell \left(i \deg(F_1)+j \deg(F_{\rm 2})\right) \leq d.\]

Since we have found other potential solutions, we need to choose the vector $\mathbf{y}$ among them. This can be done by adding other equations to the system, that are only satisfied by $\mathbf{y}$. Indeed, since the action of the automorphism group $\Sigma = \langle\sigma\rangle$ that acts on the support $\QR$ of the code $\mathcal{C}$ is given by 
\[\sigma : y \longrightarrow \xi \cd y,\]
with $\xi \in \mu^*_{\ell}(\fqm)$, the components of $\mathbf{y}$ satisfy a geometric progression by orbit: recall that the set $\QR$ is made of $r$ orbits of length $\ell$, and to simplify the notations, suppose its elements are ordered orbit by orbit. To be concrete, if $\PR = \{P_1,...,P_r\} \su \PP_K$, then elements of $\QR$ at indices $(i-1)\ell+1,...,i\ell$ correspond to the $\ell$ extensions of $P_{i}$ in $L$ (for every $1\leq i \leq r$). Let us now consider the following block matrices
\begin{equation*} 
\mathbf{A}(\xi) := 
\begin{pmatrix}
\mathbf{B}(\xi) & 0 & \cdots & 0 \\
0 & \mathbf{B}(\xi) & \cdots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 0 & \mathbf{B}(\xi)
\end{pmatrix} \ , \textrm{ where }\ 
\mathbf{B}(\xi) = 
\begin{pmatrix}
\xi & -1 & 0 & \cdots & 0 \\
0 & \xi & -1 & \cdots & 0 \\
\vdots & \ddots & \ddots & \ddots & 0 \\
0 & \ddots & \ddots & \ddots & -1 \\
-1 & 0 & \cdots & \cdots & \xi
\end{pmatrix}
\end{equation*}
and $\xi$ is the root of unity that defines $\sigma$, and $\mathbf{A}(\xi) \in M_{n}(\fqm)$. We have
\begin{equation*}
\mathbf{A}(\xi) \cd \textbf{y}^T
= 0,
\end{equation*}

and thus

\begin{equation} \label{system kummer}
\begin{pmatrix}
\mathbf{A}(\xi) \\
\mathbf{H} \cd \mathbf{D}_1 \\
\vdots \\
\mathbf{H} \cd \mathbf{D}_s
\end{pmatrix}
\cd \mathbf{y}^T = 0.
\end{equation}

The system \eqref{system kummer} is enough to recover $\mathbf{y}$ since the other solutions of $(5)$ do not satisfy this geometric progression structure, because it is clear by construction that the evaluation vectors $\mathbf{x}$ and $\boldsymbol{\alpha}$ are equal on each orbit of length $\ell$, since $\sigma$ only acts on $y$-coordinates.

\begin{rq1} Since, $\sigma$ (and so $\xi$) is supposed to be unknown at the beginning of the attack, one may have to test all the possibilities for $\xi$ in order to find the correct one. This leads to solve at most $\#\mu^*_{\ell}(\fq) = \varphi(\ell)$ linear systems like \eqref{system kummer}, which remains feasable since $\varphi(\ell)$ is rather small.
\end{rq1}

In all our computing experiences, system \eqref{system kummer} allows us to recover the desired vector \textbf{y}. To finish the attack, we only have to recover the polynomial $f$ that defines the extension $L/K$ by using a bivariate polynomial interpolation method. A detailed algorithm for this attack can be found in Annex~\ref{annexA}, as well as a complexity analysis.

\subsection{Artin-Schreier covering} \label{sectionas}

As in section~\ref{sectionkummer}, the quotient curve $\X$ is taken as a curve over $\fqm$ with separated variables, whose function field $K = \fq(x,\alpha)$ satisfies 
\[F_1(\alpha) = F_2(x),\] 
with $F_1,F_2 \in \fqm[T]$ and $\gcd(\deg(F_1),\deg(F_2))=1$. \\ 
Let $p:=\mathrm{char}(\fqm)$ and consider the extension $L=K(y)$ of $K$ defined by
\[y^p-y = f(x,\alpha),\]
with $\ f \in \fqm[X,T]$. Set $d:=\deg\left((f)^L_{\infty}\right)$ and suppose $\gcd(d,p)=1$. Then the extension $L/K$ is an Artin-Schreier extension, cyclic of order $p$ and 
\[\Gal(L/K) = \{ \sigma : y \mapsto y + \beta \ , \ \beta \in \{0,...,p-1\}\}.\]
Once again, we took $f$ as a polynomial instead of a potential rational function for the same reasons as in section 5.2 (see. Remark~\ref{pk des polynomes}).

In this case, the hypotheses of our procedure are the same as in section 5.2, knowing that this time the automorphism is completely determined by the choice of an element $\beta \in \mathbb{F}_p$. Here again, our goal is to recover $f \in \fqm[X,T]$. Using the defining equation of the function field $L$ and the fact that $d$ is prime to $p$, we can show that the place $Q_{\infty} \in \PP_K$ (same notations as in Lemma~\ref{ramification}) is totally ramified in $L/K$. As usual, we denote by $P_{\infty}$ its unique extension in $L$. With our choice of parameters and hypotheses, we can prove:

\begin{prop1} \label{propcle2}
We have
\[(x)^L_{\infty} = p \cd \deg(F_1) \cd Q_{\infty},\]
\[(\alpha)^L_{\infty} = p \cd \deg(F_2) \cd Q_{\infty},\]
and
\[(y)^L_{\infty} = d \cd Q_{\infty}.\]
\end{prop1}

\begin{proof}
Similar to the proof of Proposition~\ref{propcle} above.
\end{proof}

Note that this is almost the same result as in the Kummer case, and that the pole divisor of $y$ in $L$ is only supported by $P_{\infty}$ also. As a result, the divisor in $K$ that we will use to construct our linear system is here given by 
\[D = \tilde{G} - \left\lceil\frac{d}{p}\right\rceil \cd P_{\infty} \in \Div(K).\]
This allows us to construct the linear system (5), since $D$ can be constructed from our hypotheses. 

In the Artin-Schreier case, a monomial $x^i\alpha^j \in K$ gives a solution vector if and only if 

\[p  (i \deg(F_1)+j \deg(F_2)) \leq d.\]

To find the good solution, we again add other equations that are only satisfied by it. Here, the action of $\sigma$ on $\QR$ is given by 
\[\sigma : y \longmapsto y + \beta,\]
where $\beta \in \mathbb{F}_p$. Thus the vector \textbf{y} we are searching for satisfies an arithmetic progression by orbit. In order to see it fluently, let us assume again that the support $\QR$ is ordered by orbit. We consider the following block matrices:

\begin{equation*} 
\mathbf{C} := 
\begin{pmatrix}
\mathbf{B} & 0 & \cdots & 0 \\
0 & \mathbf{B} & \cdots & 0 \\
\vdots & \ddots & \ddots & \vdots \\
0 & \cdots & 0 & \mathbf{B}
\end{pmatrix} \ , \mathrm{where} \ 
\mathbf{B} = 
\begin{pmatrix}
-1 & 1 & 0 & \cdots & 0 \\
0 & -1 & 1 & \cdots & 0 \\
\vdots & \ddots & \ddots & \ddots & 0 \\
0 & \ddots & \ddots & \ddots & 1 \\
1 & 0 & \cdots & \cdots & -1
\end{pmatrix}.
\end{equation*}
Then 
\begin{equation*}
\mathbf{C} \cd \textbf{y}^T
= 
\begin{pmatrix}
\beta \\
\vdots \\
\beta
\end{pmatrix},
\end{equation*}
where $\beta$ is the element in $\mathbb{F}_p$ that defines the automorphism $\sigma$ (note that $\beta$ is supposed to be unknown here, but as in Kummer case, we can seek for it in a reasonable time). Adding this to~\eqref{system}, we get

\begin{equation} \label{a-s system}
\begin{pmatrix}
\mathbf{C}\\
\mathbf{H} \cd \mathbf{D}_1 \\
\vdots \\
\mathbf{H} \cd \mathbf{D}_s
\end{pmatrix}
\cd \mathbf{y}^T = 
\begin{pmatrix}
\beta \\
\vdots \\
\beta \\
0 \\
\vdots \\
0
\end{pmatrix} 
\end{equation}

The new system \eqref{a-s system} allows us to isolate \textbf{y}, since the other solutions do not satisfy this arithmetic progression, for the same reason as in the Kummer case. Finally, we can finish the attack by retrieving the polynomial $f$ using an interpolation method. 

\subsection{Extension to solvable Galois covering} \label{solvable}

In Sections~\ref{sectionkummer} and~\ref{sectionas}, we applied our attack in the special case of Kummer and Artin-Schreier covers. These cases are especially interesting since they are the elementary blocks of cyclic covers (see \cite{Sti}, Annex A.13 for a characterization of cyclic extensions of function fields). Our aim in this section is to generalize the attack in the case of a solvable Galois covering.

\begin{rq1} \label{racinesdel'unite}
We warn the reader about the definition of Kummer extensions. In fact, let $L/K$ be an order $\ell$ cyclic extension of function fields over $\fqm$. If $\gcd(\ell,\mathrm{char}(\fqm))=1$, then $L/K$ is a Kummer extension if and only if the primitive $\ell$-th roots of unity are in $\fqm$, which is given by the condition $\ell \mid q^m-1$. As we aim to apply several times the attack described in section \ref{sectionkummer} in our generalization, this condition needs to be satisfied at each iteration.
\end{rq1}

Throughout all this section, we keep the same notations as in section~\ref{sectionfour}, and we add the assumption that the Galois group $\G := \mathrm{Gal}(L/K)$ is solvable,   meaning that there exist a sequence of normal subgroups 
\begin{equation} \label{jordan holder seq}
 \{Id\} := \G_0 \triangleright \G_1 \triangleright \cdots \triangleright \G_s := \G, 
\end{equation} 
such that any quotient $\G_{i+1}/\G_i$ in~\eqref{jordan holder seq} is cyclic of degree $n_i \in \N$. 
More precisly, let $p := \mathrm{char}(\fqm)$ and write $n_i = p^{r_i}m_i$, with $(m_i,\mathrm{char}(\fqm))=1$. According to Remark~\ref{racinesdel'unite}, we also suppose that $m_i \mid q^m-1$ for all $0\leq i\leq s-1$, meaning that $\fqm$ contains all the $m_i's$ primitive roots of unity. 

\begin{rq1} \label{base_filed_extension}
The above conditions on roots of unity is not mandatory since we could extend the base field. Nevertheless, considering bigger base field would increase the complexity of our algorithms, as we will see later in Annex B. For simplicity, we will stick with these assumptions for the remaining of this section, even it weakens our generalization.  
\end{rq1}

Let us denote $L_i := L^{\G_i}$ the fixed field by $\G_i$, for all $0 \leq i \leq s$. Note that $L_0=L$ and $L_s=K$. From Galois theory, the sequence \eqref{jordan holder seq} leads to a tower of function fields
\begin{equation} \label{tower}
K := L_s \su L_{s-1} \su \cdots \su L_0 := L
\end{equation}
such that for every $0\leq i\leq s-1$, the extension $L_i/L_{i+1}$ is cyclic, with Galois group $\G_{i+1}/\G_i$. In particular, the tower \eqref{tower} corresponds to a sequence of cyclic covers of $\fqm$-curves:
\begin{equation} \label{curve tower}
\Y := \X_0 \longrightarrow \X_1 \longrightarrow \cdots \longrightarrow \X_s := \X.
\end{equation}
For every $0 \leq i \leq s-1$, the curve $\X_i$ is equipped with the action of the group $\G_{i+1}/\G_i$, and $\X_{i+1}$ is the corresponding quotient curve. \\
Now let us assume that we want to attack the secret structure of a public SSAG code on the curve $\Y=\X_0$, say
\[\C_0 := \ssag_q(\X_0,\QR_0,G_0),\]
for some support $\QR_0$ and divisor $G_0$ on $\X_0$. In the context of section 4, let us suppose that we know the secret structure of the invariant code 
\[\C_s:= C_0^{\G} = \ssag_q(\X_s,\QR_s,G_s)\]
on the smallest curve $\X_s=\X$. It is then possible to attack the secret structure of $\C_0$ from the knowledge of $\C_s$, by applying the attack of section 4 multiple times, each step allowing us to recover a subcode $\C_i=\ssag_q(\X_i,\QR_i,G_i)$ of $\C_0$ defined over $\X_i$. Depending on the order $\G_{i+1}/\G_i$, we are led to use either section~\ref{sectionkummer} or section~\ref{sectionas}.

 \noindent More precisly, fix $0 \leq i \leq s-1$ and recall $n_i = p^{r_i}m_i$, with $(m_i,p)=1$ and $m_i \mid q^m-1$. If we know the structure of the code $\C_i = \ssag_q(\X_i,\QR_i,G_i)$ as well as a generator matrix of $\C_0$ and the corresponding automorphism acting on it, we can apply successively $r_i$-times the Artin-Schreier case and one time the Kummer case with degree $m_i$ (possible since $m_i \mid q^m-1$) in order to build an SSAG code $\C_{i+1}$ defined over $\X_{i+1}$. 

\noindent This way, we can ride up the sequence of curves~\eqref{curve tower} until we have rebuilt the public code $\C_0$. 

\begin{rq1}
For every $0 \leq i \leq s-1$, $\C_i := \C_{i+1}^{\G_{i+1}/\G_i}$. 
\end{rq1}

\begin{rq1} \label{induced permutation} The hypothesis 3 in section~\ref{sectionfour} needs to be explained a bit in this framework. It says that for any place in the invariant support $\QR_s$, we know which elements in $\QR_0$ are its extensions. From this knowledge, we can extract a parity check matrix of any code in the sequence $(\C_i)_i$ from the public generator matrix, which is necessary to build the linear systems we have to solve at each step. 
\end{rq1}

\begin{expl} With previous notations, let $\G=\Gal(L/K)$ be a solvable Galois group of order $\#\G = ps$, with $(p,s)=1$ and $s \mid q^m-1$. Suppose we are given a generator matrix of the code $\C_0 = \ssag_q(\Y,\QR,G)$, as well as the knowledge of its invariant code $\C_2 := \ssag_q(\X,\PR,\tilde{G})$. We proceed as follow: 
\begin{enumerate}
\item[1.] We start by applying section~\ref{sectionas} on $\C_2$ in order to build a subcode $\C_1 = \ssag_q(\X',\PR',G')$ of $\C_0$ defined over an intermediary curve $\X'$ with function field $F$, such that both extentions $L/F$ and $F/K$ are cyclic, with respective order $s$ and $p$ (the first one being a Kummer extension, the second an Artin-Schreier one).
\item[2.] From the knowledge of the code $\C_1$, we can now apply section~\ref{sectionkummer} (possible since $L/F$ as order $s \mid q^m-1$) in order to recover the secret structure of $\C_0$.
\end{enumerate}
\end{expl}

In the next section, we will describe some possible attacks against the invariant code, since we have proved in section~\ref{sectionfour} that under the correct hypotheses, its knowledge allows us to recover the associated SSAG code.


\section{Known attacks against the invariant code} \label{section6}


In this section, we focus more on the coding theory point of view. In particular, we will be dealing with McEliece's enryption schemes (see~\cite{McE} for more details), which is a public key cryptosystem whose security rely on a linear code. In our settings, the secret key of the scheme is given by the structure of a quasi-cyclic SSAG code. From the attack of section~\ref{sectionfour}, we know that this security reduces (under some assumptions) to the security of the invariant code. 

\vspace*{0.2cm}

\noindent As a consequence, we could decide to choose the invariant code as the public key while building the scheme, which actually would not affect key sizes. Nevertheless, this would make \textit{message recovery attacks} easier, because solving the \textit{Syndrome Decoding Problem} is faster with smaller parameters. We do not go further into details here, but some solving methods are explaned in the paper of Peters \cite{PET}, and come from improvments of the attack by \textit{Information-set Decoding}, introduced by Prange in \cite{PR62}. For the remaining of this section, we will study the security of such schemes.

\vspace*{0.2cm}

\noindent Keeping usual notations, consider a Galois cover $\Y \longrightarrow X$ of smooth irreductible projective curves over $\fqm$, and let us denote by 
\[\mathcal{C}_{\mathrm{pub}} = \ssag_q(\Y,\QR,G)\]
the public $\ell$-quasi-cyclic SSAG code of a McEliece's scheme.
As shown by Corollary~\ref{ssag}, the invariant subcode $\mathcal{C}_{\mathrm{inv}}$ is an SSAG code on the quotient curve $\X$, say
\[C_{\mathrm{inv}} := \ssag_q(\X,\PR,\tilde{G}).\]
Note that Remark~\ref{gen inv} implies that this code can be constructed in polynomial time from a generator matrix of $\mathcal{C}_{\mathrm{pub}}$ and the action of the induced permutation on it (\textit{ie.} the public key). This means that a generator matrix $\mathbf{G}_{\mathrm{inv}}$ of $\C_{\mathrm{inv}}$ must also be considered as public data. Below, we describe two possible attacks against SSAG codes. 


\subsection{Invariant code on the projective line} \label{section6.1}


In the particular case where the quotient curve $\X$ is the projective line $\PP^1$, it is possible to construct an algebraic system to recover the secret elements of $\C_{\mathrm{inv}}$ (it is a special case of \textit{algebraic attacks} already mentionned). Combining it with the attack of section~\ref{sectionfour}, we can  recover the secret key of the scheme. The main ingredient that allows us to build such a system is the fact that $\PP^1$ has genus zero and thus a trivial divisor class group. 
From Corollary~\ref{ssag}, the invariant code is given by 
\[C_{\mathrm{inv}} := \ssag_q(\PP^1,\PR,\tilde{G}).\]
To construct an algebric system, we start from the inclusion 
\[C_{\calL}(\PP^1,\PR,\tilde{G})^{\perp} \su \ssag_q(\PP^1,\PR,\tilde{G})^{\perp} \otimes \fqm,\]
that is a direct consequence of definitions (in the right-hand side, we have extended the scalars to $\fqm$ since it is the field definition of the AG code). This means that for every codeword $\mathbf{c} \in C_{\calL}(\PP^1,\PR,\tilde{G})^{\perp}$, we have 
\begin{equation} \label{eq12}
\mathbf{c} \cd \mathbf{G}_{\mathrm{inv}}^T = 0.
\end{equation} 
Moreover, we know from Proposition~\ref{dual} that there exists a divisor $G' \in \Div(\PP^1)$ such that
\[ C_{\calL}(\PP^1,\PR,\tilde{G})^{\perp} = C_{\calL}(\PP^1,\PR,G').\]
As a consequence, the knowledge of a basis of the Riemann-Roch space $\calL_{\mathbb{P}^1}(G')$ allows us to write formally codewords in $C_{\calL}(\PP^1,\tilde{\PR},G')$, without knowing the support $\PR$. Since $\PP^1$ has a trivial divisor class group, there exists a function $h$ in the rational function field $\fqm(x) = \fqm(\PP^1)$ such that
\[ G' = (h)^{\fqm(x)} + \deg(G') \cd \infty,\]
where $\infty$ is the unique pole of $x$ in $\fqm(x)$. From the last equality, we get
\[\calL_{\mathbb{P}^1}(G') = \langle h(x)x^i \ | \ 0 \leq i \leq \deg(G')\rangle_{\fqm},\]
which has dimension $k:=\deg(G')+1$ (consequence of the Riemann-Roch theorem and the fact that the projective line has genus $0$). \\
Let us write the unknown support $\PR = (P_1,\cdots,P_r)$, with $P_i := (x_i:1)$ (here we made the analogy between projective points and rational places). The goal is to recover the $x_i's$, which are the evaluations of the rational function $x$ at the places $P_i's$. For that, we denote by  
$\mathbf{X} = (X_1,\cdots,X_r)$ and $\mathbf{Z} = (Z_1,\cdots,Z_r)$ two sets of formal variables, respectively corresponding to $x_i's$ and $h(x_i)'s$. From~\eqref{eq12}, we have
\begin{equation} \label{system_over_P1}
\begin{pmatrix}
Z_1 & \cdots & Z_r \\
Z_1X_1 & \cdots & Z_{r}X_{r} \\
\vdots & \ddots & \vdots \\
Z_rX_r^{k} & \cdots & Z_{r}X_{r}^k 
\end{pmatrix}
\cd \mathbf{G}_{\mathrm{inv}}^T= 0.
\end{equation}

\noindent The first row provides $k=\dim_{\fq}(\mathcal{C}_{\mathrm{inv}})$ linear equations in the variables $\mathbf{Z}$, and since $k < r$, we can eliminate some variables in the set $\mathbf{Z}$. On the other hand, the 2-transitivity of the affine group on $\fqm$ allows us to fix arbitrarily 2 unknows, say $x_1$ and $x_2$. Therefore, the above system consist in $kr$ equations in $r-2$ variables $\mathbf{X}$ and $r-k$ variables $\mathbf{Z}$. \\
If we are able to solve it, we recover the function $h$ (and thus the invariant divisor $\tilde{G}$) as well as the support $\PR$; \textit{ie.} the full structure of the invariant code. Since the security of the whole system rely on it, we have broke the scheme.  

\begin{rq1} 
The cost of solving~\eqref{system_over_P1} is hard to estimate. We can have an upper bound on it if the system has a specific form, which can be useful to study the security of schemes using SSAG codes over the line. Theses results can be found in \cite{FOP}, \cite{FOP1} and \cite{FOP2}. 
\end{rq1}

The above discussion shows that if the quotient curve is $\PP^1$, the security is the same as the scheme using quasi-cyclic classical Goppa codes, and thus there is no advantages to use it. In particular, this means that the automorphism should be chosen such that the quotient curve is not rational. In the latter case, the fixed field has a more complex divisor class group and the above attack does not work. In the next section, we will describe the cost of an exhaustive search on the invariant code, depending on different parameters of the fixed field. 


\subsection{Brute force on the invariant code} \label{bruteforce}


Here, we keep the previous notations and we consider the invariant code over the quotient curve $\X$ given by
\[C_{\mathrm{inv}} := \ssag_q(\X,\PR,\tilde{G}).\]
A brute force attack on it consists in recovering its secret structure from one of its generator matrix. It is devided inti three steps:
\begin{enumerate}
\item Enumerate all the possible divisor classes of a given degree on the quotient curve $\X$;
\item Guess the good divisor $\tilde{G}$ in the class;
\item Guess the support $\PR$ of length $r:=n/\ell$, where $\ell$ is the quasi-cyclicity order and $n$ the length of the public code.
\end{enumerate}

We start by discussing the third step, which is the easiest to formalize. 

\vspace*{0.2cm}

\noindent \textbf{Recovering the invariant support.} Here we assume that the first two steps were done and that a divisor $\tilde{G}$ was found. To recover the invariant support, there are two ways to proceed: 

\vspace*{0.2cm}

\noindent The first consists in an exhaustive search on all subset $S \su \X(\fqm)$ of length $r$, then we recover the good permutation using the SSA algorithm (see \cite{SSA} for more details). 

\vspace*{0.2cm}

\noindent The second is to solve a linear system as in section~\ref{section6.1}. In order to build it, we start by recalling that there exists (from Proposition~\ref{dual}) a divisor $G' \in  \Div(\X)$ such that 
\[ C_{\calL}(\X,\PR,\tilde{G})^{\perp} = C_{\calL}(\X,\PR,G').\]

\noindent The main difference with the attack of section~\ref{section6.1} is that we do not know the curve $\X$ from our hypotheses. Nevertheless, let us suppose that the attacker found a way to recover it, meaning that it is possible to find a basis of the Riemann-Roch space $\calL_K(G') \su K:=\fqm(\X)$, \textit{ie.} we have $\calL_K(G') = \langle f_1,...,f_r \rangle_{\fqm}$, where $r = \dim(G')$. If $\PR := \{P_1,\cdots,P_r\}$, we get 
\begin{equation*}
\forall \ 1 \leq i \leq r \ , \ (f_i(P_1),\cdots,f_i(P_r)) \cd \mathbf{G}_{\mathrm{inv}}^T = 0.
\end{equation*}
From this point, we can build a linear system whose unknows are the elements of $\PR$.
Note however that this system is even harder to solve than~\eqref{system_over_P1}, since we can not estimate the form of the rational functions $f_i's$. Even if the system is polynomial, the complexity of solving it using Gröbner bases depends on the form and degree of the polynomials and is thus difficult to forecast.

\vspace*{0.2cm}

\noindent \textbf{Enumeration of divisor classes.} We start by explaining why it is not necessary to enumerate all divisors in to find the correct one. In fact, if the support is fixed, two different divisors can produce the same code. This fact comes from the specific structure of SSAG codes, inherited from AG ones. To precise this, we introduce the notion of diagonal equivalent codes.

\begin{def1} \label{diag}
Let $\C_1$,$\C_2 \su \fqm^n$ be two linear codes. We say they are diagonal equivalent, denoted \ $\C_1 \sim_{\mathrm{diag}} \C_2$, if there exist $n$ non zero scalars $\lambda_1,...,\lambda_n$ in $\fqm$ such that 
\[\C_1 = (\lambda_1,...,\lambda_n) \star \C_2 := \{(\lambda_1c_1,...,\lambda_nc_n) \ | \ (c_1,...,c_n) \in \C_2\}.\]
\end{def1} 

Note that the diagonal equivalence between two codes $\C_1$ and $\C_2$ can be checked by solving yet another linear system. In fact, let $\mathbf{G}_{\C_1}$ and $\mathbf{H}_{\C_2}$ be respectively a generator matrix of $\C_1$ and a parity check matrix of $C_2$. Let also $W_1,...,W_n$ be $n$ formal variables, and consider the following system
\begin{equation} \label{equiv}
\mathbf{G}_{\C_1} \cd \begin{pmatrix}
W_1 & \cdots & 0 \\
\null & \ddots & \null \\
0 & \cdots & W_n
\end{pmatrix} \cd \mathbf{H}_{\C_2}^T = 0.
\end{equation}

\noindent By Definition~\ref{diag}, this system has at least one solution if and only if $\C_1 \sim_{\mathrm{diag}} \C_2$, which provides an easy way to check whever two codes are diagonal equivalent or not. \\
This property leads to a smarter brute force search on the divisor in the case of SSAG codes. We first deal with the case of AG codes as they are easier to treat. 

\begin{thm} [\cite{CMRP}, Corollary 4.15.]  \label{thmequiv}
Let $\X$ be a smooth irreducible projective curve of genus $g(\X)$ and $\PR$ be a set of $n>2g(\X)-2$ rational places on $\X$. If $G,H \in \Div(\X)$ are two divisors of same degree $r$ such that $2g(\X)-1 < r < n-1$, then  
\[C_{\calL}(\X,\PR,G) \sim_{\mathrm{diag}} C_{\calL}(\X,\PR,H) \iff G \sim H.\]
\end{thm}

Let us denote by $\mathrm{AG}_r(\X,\PR)$ the set of AG codes on $\X$, defined by a fixed support $\PR$ and any divisor of degree $r$. The above theorem implies

\begin{coro1} \label{nbAGr}
Let $\PR \su \X(\fqm)$ be a support of lenght $n > 2g(\X)+2$ and $r \in \N$ be such that $2g(\X)-1 < r < n-1$. Then 
\[ \#\left(\mathrm{AG}_r(\X,\PR)/ \sim_{\mathrm{diag}}\right)= h(\X),\]
where $h(\X)$ is the number of divisor classes.
\end{coro1}

The above estimation is sufficient if we want to perform a brute force search on an AG code. We could proceed as follows:
\begin{enumerate}
\item Perform a brute force search among divisor classes of degree $r$, \textit{ie.} choose a representative divisor $G'$ in the class.
\item Guess a support $\PR'$ (see above) and attempt to solve the system \eqref{equiv} to check whether \\ $C_{\calL}(\X,\PR',G')$ is diagonal equivalent to the public code or not.
\item If \eqref{equiv} has a non zero solution $(\lambda_1,...,\lambda_n) \in (\fqm^*)^n$, then we have recovered~the public code $(\lambda_1,...,\lambda_n) \star$ $C_{\calL}(\X,\PR',G')$.
\end{enumerate}

Both Theorem~\ref{thmequiv} and Corollary~\ref{nbAGr} provide an estimation of the cost of a brute force search amoung divisor classes in the case of AG codes. Unfortunately,  theses results do not hold with SSAG codes. In the latter case, the situation is more complicated but we can have a first estimation by using the following proposition.

\begin{prop1}[\cite{CMRP}, Corollary 7.4] 
With notations of Corollary~\ref{nbAGr}, if $n>2g(\X)+2$ and $2g(\X)-1<r<n$, then 
\[\#\mathrm{AG}_r(\X,\PR) = (q^m-1)^{n-1}h(\X).\]
\end{prop1}

Now let us denote by $\ssag_{q,r}(\X,\PR)$ the set of subfield subcodes over $\fq$ of AG codes on the curve $\X$, defined by the support $\PR$ and a degree $r$ divisor. Since we are taking subcodes, it is clear from the previous proposition that 
\[\#\ssag_{q,r}(\X,\PR) \leq \#\mathrm{AG}_r(\X,\PR) = (q^m-1)^{n-1}h(\X).\]

We can decrease the previous bound thanks to the following remark.

\begin{rq1}
Let $\C_1$,$\C_2$ be two linear codes of lenght $n$ over $\fqm$, and suppose that there exist $\lambda_1,...,\lambda_n \in (\fq^*)^n$ such that $\C_1 = (\lambda_1,...,\lambda_n) \star \C_2$. Then their subfield subcodes over $\fq$ are equal, ie.
\[\C_1 \cap \fq^n = \C_2 \cap \fq^n.\]
\end{rq1}

This leads to the final upper bound 
\begin{equation} \label{nb of sssag}
 \#\ssag_{q,r}(\X,\PR) \leq \dfrac{(q^m-1)^{n-1}}{(q-1)^{n-1}}h(\X).
\end{equation} 

In Annex B, we will formally describe a brute search algorithm on the invariant SSAG code and study its complexity, which is clearly bounded by $h(\X)$. In particular, this will lead to choose optimally the automorphism $\sigma \in \Aut(\Y)$ in order this number to be high enough.

\vspace*{0.2cm}

In the next section, we propose a McEliece scheme based on a quasi-cyclic SSAG code defined over the \textit{Hermitian curve}, as well as a set of parameters to secure the corresponding invariant code against the attacks discussed above.


\section{A McEliece scheme using quasi-cyclic SSAG codes over the Hermitian curve}


\subsection{The proposed scheme}


We recall that $q$ is the power of a prime $p$, and that we work with the finite field $\fqm$. Since the Hermitian curve is defined over a field with square cardinality, we assume that $q^m = p^{2s}$ is a square. To avoid missunderstanding with the field $\fq$  where the subfield subcode is defined, we introduce an intermediary field $\mathbb{F}_{q_0}$ with $q_0 = p^s$ elements.   
We define the Hermitian curve $\calH$ over the $\fqm = \mathbb{F}_{q_0^2}$ by \\ $\fqm(\calH):=\mathbb{F}_{q_0^2}(x,y)$,with 
\begin{equation} \label{hermi}
y^{q_0}+y=x^{q_0+1}.
\end{equation}


The idea is to construct a McEliece scheme based on an SSAG code defined over $\calH$, stable under the action of some cyclic automorphism. There are two motivations to use this curve: first, it is a maximal curve,  meaning that it atteins the Hasse-Weil bound. More precisly, this curve has genus $g(\calH)= \frac{q_0(q_0-1)}{2}$ and $N(\calH)=q_0^3+1$ rational points. It allows us to consider longs codes, and thus more flexibility. Moreover, the automorphism group $\mathrm{Aut}(\mathcal{H})$ is very large and has been well-studied (see \cite{Sti} or \cite{Gar}); which gives us a large choice for our automorphism $\sigma$ (it will be important for the security of the scheme, see section~\ref{choice_of_sigma}). 

\vspace*{0.2cm}

\noindent From now on, we fix the following notations: 
\begin{enumerate}
\item[$\bullet$] $\sigma \in \mathrm{Aut}(\calH)$ is an automorphism of order $\ell \in \N^*$ (which will be chosen later);
\item[$\bullet$] $\QR := \bigsqcup\limits_{i=1}^{r} \mathrm{Orb}_{\sigma}(Q_i)$ is a support made of $r$ distincts orbits under the action of $\sigma$, and $n:=\ell r$ refers to the lenght of the public code;
\item[$\bullet$] $G = \sum\limits_{i=1}^s t_i \sum\limits_{R \in \mathrm{Orb}_{\sigma}(R_i)} R$ is a $\sigma$-invariant divisor, with $R_i \in \PP_{\mathcal{H}}$ and $t_i \in \Z$. 
\end{enumerate}

Finally, we suppose as usual that $\Supp(G)\cap \QR = \emptyset$. We can now describe our scheme: 

\vspace*{0.2cm}

\noindent \textbf{Key generation.} We consider the quasi-cyclic code 
\[\mathcal{C}_{\mathrm{pub}} := \ssag_q(\mathcal{H},\QR,G)\]
constructed on the Hermitian curve $\mathcal{H}$, with length $n \leq N(\mathcal{H})$ and dimension $k$. Let $t$ be the correction capability of the code and $\mathbf{G}_{\mathrm{pub}} = (I_k | \mathbf{M})$ be a systematic generator matrix of $\mathcal{C}_{\mathrm{pub}}$, where $\mathbf{M}$ is an $\ell$-blocks-circulant matrix, \textit{ie.} of the form 

\begin{equation*}
\mathbf{M}= \begin{pmatrix}
\cdots & \cdots & \cdots \\
\cdots & \mathbf{M}_i & \cdots \\
\cdots & \cdots & \cdots
\end{pmatrix}
\ \mathrm{with} \ \mathbf{M}_i := \begin{pmatrix}
a_0 & a_1 & \cdots & a_{\ell-1} \\
a_{\ell-1} & a_0 & \cdots & a_{\ell-2} \\
\vdots & \ddots & \ddots & \vdots \\
a_1 & \cdots & a_{\ell-1} & a_0 
\end{pmatrix}
\end{equation*}

\noindent Thus, $\mathbf{G}_{\mathrm{pub}}$ can entirely be described by the set of rows
\[\rho(\mathbf{G}_{\mathrm{pub}}) := \{M_i \ | \ i \in \{1,\ell+1,2\ell+1,...,(n-k)-\ell+1\}\},\]
where $M_i$ is the $i$-th row of $\mathbf{M}$. 

\begin{enumerate}
\item[$\bullet$] \textbf{Public key:} the set of rows $\rho(\mathbf{G}_{\mathrm{pub}})$ and the integer $t$.
\item[$\bullet$] \textbf{Secret key:} the support $\QR$ and the divisor $G$.
\end{enumerate}

\noindent \textbf{Encryption.} A plain text $\mathbf{m} \in \fq^k$ is encrypted by 
\[ \mathbf{y}  = \mathbf{m}\mathbf{G}_{\mathrm{pub}} + \mathbf{e} \ ,\]
where $\mathbf{e} \in \fq^n$ is an error vector such that $\w(\mathbf{e}) \leq t$ ($\w$ being the Hamming weight). 

\vspace*{0.2cm}

\noindent \textbf{Decryption.} Using a general decoding algorithm for algebraic geometry codes (see for example \cite{THRP}), we compute $\mathbf{c} = \mathbf{y} - \mathbf{e} \in \mathcal{C}_{\mathrm{pub}}$. From $\mathbf{c}$ and the knowledge of $\mathbf{G}_{\mathrm{pub}}$, we can recover the message $\mathbf{m}$. 

\vspace*{0.2cm}

The security of the scheme is based on the support $\QR$ and the divisor $G$ which are unknown. However, we know from Corollary~\ref{ssag} that the invariant code is an SSAG code on the quotient curve $\mathcal{H}/\langle \sigma \rangle$. Recall that the attack proposed in section~\ref{sectionfour} shows that the security reduces to the security of the invariant code. To secure our scheme, we need to ensure that it can not be recovered easily. In particular, we propose in the next section a set of parameters to be out of range of the attacks described in section~\ref{section6}.


\subsection{Suggested parameters}


\subsubsection{Choice of the quasi-cyclicity order $\ell$} \label{choice of l}


The main interest in using quasi-cyclic codes is that it allows us to reduce public key sizes. In particular, the larger $\ell$ is, the smaller the public key is. This choice also influences the security of the scheme, as the security reduces to the security of the invariant code. In particular, if $\ell$ is too large, the invariant code will be rather small and probably less secured. Recall that it is possible to build the invariant code from a public generator matrix and the permutation induced by $\sigma$. Here we would like to choose $\ell$ such that it is not possible to construct any other subcode. We have two ways to avoid this.

\begin{enumerate}
\item \textbf{$\ell$ shoud be prime}. In fact, if there exists a prime $s \mid \ell$, then the power permutation $\sigma^s$ also acts on the public code. In particular, $\C_{\textrm{pub}}$ is also $s$-quasi-cyclic, and thus we can construct another invariant code, \textit{ie.} $\C_{\textrm{pub}}^{\sigma^s}$. Since this is possible for every divisor of $\ell$, we are able to construct several SSAG-subcodes of the public code. Actually, we don't know if it makes the attack easier, but it is clear that every intermediary code could provides informations about the secret support and divisor. As we want to give the least information possible, $\ell$ will be chosen as a prime.

\item \textbf{$\ell$ should be such that $q$ is in $\mu_{\ell -1}^*(\fqm)$}. If this is satysfied, the polynomial $1+z+z^2++z^{\ell-1} \in \fq[z]$ is irreducible. This is motivated by the fact that there exists another intermediary code that can be constructed from the knowledge of a generator matrix and the induced permutation, namely the \textit{folded code} (see \cite{FOP}). It is defined as the image of $\C_{\textrm{pub}}$ by the map $\mathrm{id} +\sigma+...+\sigma^{\ell-1}$. Now, if the polynomial $1+z+z^2+...+z^{\ell-1}$ is reducible over $\fq$, then it is possible to construct another intermediary subcode by computing the image by the map $P(\sigma)$, where $P$ is a divisor of $1+z+z^2+...+z^{\ell-1}$. Again, we get another subcode that has a special structure related to the secrets of the scheme. We don't know if the knowledge of several folded codes simplify an attack, but it is a safer choice to make this assumption.
\end{enumerate}

\begin{rq1} \label{un seul subcode} 
From its definition, the folded code is $\sigma$-invariant, meaning that is is a subcode of $\C_{\mathrm{pub}}^{\sigma}$. If $p \nmid \ell$, then we can show that these two codes are equal (see \cite{Bar1} , Lemma 3.2). Hence, if $\ell$ satisfies both the above conditions and if $p \nmid \ell$, then the only subcode of $\mathcal{C}_{\mathrm{pub}}$ that an attacker can construct is the invariant code. In particular, we can focus on its security without having to worry about possible other subcodes.  
\end{rq1}


\subsubsection{Choice of the automorphism $\sigma$} \label{choice_of_sigma}


The complexity of the brute force attack on $\C_{\textrm{inv}}$, described in \ref{bruteforce}, depends on the class number of the quotient curve $h(\mathcal{H}/\langle \sigma \rangle)$. In particular, from Theorem~\ref{esti h(X)}, this number can be estimated using the genus $g(\mathcal{H}/\langle \sigma \rangle)$. In this section, we detail how to construct an automorphism $\sigma \in \Aut(\h)$ of order $\ell$, with $\ell$ satisfying both conditions of section~\ref{choice of l}. After, we will see the influence of this choice on the genus of the quotient curve. A complete study on the automorphism group of the Hermitian curve can be found in \cite{Gar}. In particular, they compute the class number as well as the genus of several quotient curves. 

\vspace*{0.2cm}

\noindent \textbf{Seeking for an order $\ell$ automorphism.} Let us denote by $\calA := \Aut(\calH)$ the automorphism group of the Hermitian curve. It is isomorphic to the projective unitary group $\mathrm{PGU}_3(\mathbb{F}_{q_0^2})$ (see~\cite{Sti}), and has order 
\[\mathrm{ord}(\calA) =  q_0^3(q_0^2-1)(q_0^3+1).\]
We then introduce the subgroup
\[\calA(Q_{\infty}) := \{ \sigma \in \calA \ | \ \sigma(Q_{\infty}) = Q_{\infty}\} \su \calA ,\]
consisting in all automorphisms fixing the unique point at infinity $Q_{\infty}$ in $\calH(\mathbb{F}_{q_0^2})$. If $\mathbb{F}_{q_0^2}(x,y)$ is the function field of $\h$, defined in~\eqref{hermi}, then any automorphism in $\calA(Q_{\infty})$ acts as follows:
\begin{equation} \label{sigma}
\left\{ \begin{array}{ll}
\sigma(x) = ax+b \\
\sigma(y) = a^{q_0+1}y+ab^{q_0}x+c,
\end{array} \right.
\end{equation}
with $a \in \mathbb{F}_{q_0^2}^*$, $b \in \mathbb{F}_{q_0^2}$ and $b^{q_0+1} = c^{q_0}+c$ (see (2.2) in \cite{Gar}). We also have 
\[\mathrm{ord}(\calA(Q_{\infty})) = q^3(q^2-1).\]
According to~\eqref{sigma}, any element $\sigma \in \calA(Q_{\infty})$ can be identified to a triple $(a,b,c)$. For convenience, it will be denoted by $\sigma=[a,b,c]$.
Next we show that the order of such an automorphism depends only on the order of $a$ and the choice of $c$.

\begin{lem1}(see \cite{Gar}, Lemma 4.1.)\label{ordsigma}
Let $\sigma = [a,b,c] \in \calA(Q_{\infty})$, with $a \neq 1$. We have
\begin{itemize}
\item[(i)] If $\mathrm{ord}(a) \nmid q_0+1$, then $\mathrm{ord}(\sigma) = \mathrm{ord}(a)$;
\item[(ii)] If $\mathrm{ord}(a) \mid q_0+1$ then
\begin{equation*}
\mathrm{ord}(\sigma) = \left\{\begin{array}{ll}
\mathrm{ord}(a), \ \mathrm{if} \ c=\dfrac{ab^{q_0+1}}{a-1} \\
p \cd \mathrm{ord}(a), \  \mathrm{otherwise}. 
\end{array}
\right.
\end{equation*}
\end{itemize}
\end{lem1}

Now, let $\ell$ be an integer satisfying both conditions in~\ref{choice of l}, and such that $\ell \mid q_0^2-1$. We randomly pick $a \in \mathbb{F}_{q_0^2}^*$ of order $\ell$ and $b \in \mathbb{F}_{q_0^2}$. If $\ell \mid q_0+1$, we set $c:=\frac{ab^{q_0+1}}{a-1}$, else we choose any $c$ amoung the roots of $X^{q_0}+X-b^{q_0+1}$. From Lemma~\ref{ordsigma}, the automorphism $\sigma = [a,b,c]$ has order $\ell$. 

\vspace*{0.2cm}

\noindent \textbf{The genus of $\calH/\langle \sigma \rangle$}. The authors in \cite{Gar} provide a genus formula to compute $g(\calH/\langle \sigma \rangle)$ when $\sigma \in \calA(Q_{\infty})$.

\begin{prop1} \label{genus}
Let $\sigma = [a,b,c] \in \calA(P_{\infty})$ be an automorphism of prime order $\ell > 2$.
\begin{itemize}
\item[(i)] If $\ell \mid (q_0-1)$, then $g(\calH/\langle \sigma \rangle) = \frac{(q_0-1)q_0}{2\ell}$.
\item[(ii)] If $\ell \mid (q_0+1)$ and $c = \frac{ab^{q_0+1}}{a-1}$, then $g(\calH/\langle \sigma \rangle) = \frac{(q_0-1)(q_0-(\ell-1))}{2\ell}$.
\end{itemize}
\end{prop1}

\begin{proof}
see \cite{Gar}, Theorem 4.4.
\end{proof}

Notice that since we want the quotient curve to have positive genus, $\ell$ should be strictly less than $q_0+1$. Using this proposition and Theorem~\ref{esti h(X)}, we can estimate the class number $h(\calH/\langle \sigma \rangle)$:

\begin{coro1} \label{lastcorollary}
Let $\sigma = [a,b,c] \in \calA(Q_{\infty})$ be an automorphism of prime order $\ell > 2$. 
\begin{itemize}
\item[(i)] If $\ell \mid (q_0-1)$, then $h(\calH/\langle \sigma \rangle) = \calO \left(q_0^{\frac{q_0^2}{\ell}}\right)$.
\item[(ii)] If $\ell \mid (q_0+1)$ and $c=\frac{ab^{q_0+1}}{a-1}$, then $h(\calH/\langle \sigma \rangle) = \calO \left(q_0^{\frac{q_0(q_0-1)}{\ell}}\right)$.
\end{itemize}
\end{coro1}


As we have seen in section~\ref{bruteforce}, the complexity of the brute force attack on the invariant code is upper bounded by the class number $h(\calH/\langle \sigma \rangle)$ (see~\eqref{nb of sssag}). In~\ref{some parameters}, we propose some parameters for our scheme such that this class number is large enough to reach the desired security.


\subsubsection{Choice of the base field}


To provide SSAG codes over the base field $\fq$, we have to choose an extension $\fqm$ of $\fq$ such that $q^m$ is a square. Let us discuss the choice of $q$,$m$ and $q_0$ such that $q^m=q_0^2$.

\begin{enumerate}
\item[$\bullet$] $m$ should not be too large since it has a negative influence on the dimension of the code. In fact, for a fixed lenght $n$ and divisor $G$, the dimension of the SSAG code is lower bounded by $n-m(n-\dim(G))$ (consequence of Delsarte's theorem). As a result, if $m$ is too big, the rate (\textit{ie.} $k/n$) of the code might be too low, which is not desired in practice.
\item[$\bullet$] The same remark holds for the choice of $q_0$: since $g(\calH)=\frac{q_0(q_0-1)}{2}$, the dimension $k$ of the SSAG code satysfies 
\[k \geq n-m(n-\dim(G)) = n-m(n- \deg(G) +g(\calH)-1),\]
so $q_0$ should not be too large as well.
\item[$\bullet$] On the other hand, the choice $q=q_0$ and $m=2$, which satisfies both the previous points, is not encouraged. The formal argument in this direction is that the smaller the extension degree $m$ is, the closer the structure of the SSAG code is from the AG one. Since the latter have been broken in polynomial time (see \cite{Cou}), it might be possible to addapt this in the subfield subcode scenario. In the upcoming section, we still provide some parameters with $m=2$ because it results in the best key sizes, but we warn the reader that it could be the weakest keys. 
\end{enumerate}
 

\subsubsection{Parameters} \label{some parameters}


Let us fix the notations used in the following tables:

\begin{enumerate}
\item[$\bullet$] $q$ is the power of a prime such that the SSAG code is defined over $\fq$.
\item[$\bullet$] $m$ is the extension degree such that the underlying AG code is defined over $\fqm$.
\item[$\bullet$] $q_0$ is a prime power such that $q_0^2=q^m$.
\item[$\bullet$] $n$ and $k$ are respectively the length and the dimension of the public code.
\item[$\bullet$] $\ell$ is the quasi-cyclicity order (\textit{ie.} the order of the automorphism $\sigma$).  
\item[$\bullet$] $g(\calH/\langle \sigma \rangle)$ and $h(\calH/\langle \sigma \rangle)$ are respectively the genus and the class number of the quotient curve.
\item[$\bullet$] Key sizes are given in bytes, and computed with the formula $\left\lceil \frac{\log_{2}(q) \cd \frac{k}{l} \cd (n-k)}{8} \right\rceil,$ since public keys are systematic and quasi-cyclic generator matrices of $[n,k]$-codes.
\item[$\bullet$] $\w_{\mathrm{ISD}}$ is the log$_2$ of the work factor for the \textit{Information-set Decoding} (ISD) attack, computed using \textbf{CaWoF} library (see. \cite{CAWOF}).
\end{enumerate}
The desired security is 128 bits, and we keep in mind that the class number $h(\calH/\langle \sigma \rangle)$ is an upper bound for the brute force attack. 

\begin{table}[htbp]
\begin{equation*}
\begin{array}{|c|c|c|c|c|c|c|c|c|c|}
\hline
m & q & q_0 & n & k & \ell & \mathrm{Key} \ \mathrm{sizes} \ (\mathrm{bytes}) & \w_{\mathrm{ISD}} & g(\calH/\langle \sigma \rangle) & h(\calH/\langle \sigma \rangle) \\
\hline
8 & 2 & 2^4 & 4083 & 2307 & 3 & 170718 & 128 & 40 & \simeq 2^{326} \\
\hline
8 & 2 & 2^4 & 4085 & 2315 & 5 & 102438 & 129 & 24 & \simeq 2^{196} \\
\hline \hline
4 & 2^2 & 2^4 & 3000 & 1246 & 3 & 182123 & 128 & 40 & \simeq 2^{326} \\
\hline
4 & 2^2 & 2^4 & 3000 & 1252 & 5 & 109424 & 129 & 24 & \simeq 2^{196} \\
\hline \hline
3 & 3^2 & 3^3 & 2996 & 1277 & 7 & 124258 & 130 & 39 & \simeq 2^{374} \\
\hline
\end{array}
\end{equation*}
\caption{Suggested parameters for security 128, $m > 2$}
\end{table}

For some parameters with $m=2$ in the table below, we have $h(\calH/\langle \sigma \rangle) < 2^{128}$, in which case we precise the number $\#\ssag_{q,r}(\calH/\langle \sigma \rangle,\PR)$ of SSAG codes over $\fq$ with same support $\PR$ and a degree $r$ divisor.

\begin{table}[htbp]
\begin{equation*}
\begin{array}{|c|c|c|c|c|c|c|c|c|c|}
\hline
m & q  & n & k & \ell &\mathrm{Key} \ \mathrm{sizes} \ (\mathrm{bytes}) & \w_{\mathrm{ISD}} & g(\calH/\langle \sigma \rangle) & h(\calH/\langle \sigma \rangle) & \#\ssag_{q,r}(\mathcal{H},\PR)  \\
\hline
2 & 11  & 900 & 613 & 3 & 25359 & 128 & 15 & \simeq 2^{107} & \simeq 2^{6316} \\
\hline
2 & 11  & 1200 & 740 & 5 & 29439 & 128 & 11 & \simeq 2^{78} & \simeq 2^{8360}\\
\hline \hline
2 & 13  & 1299 & 775 & 3 & 62614 & 128 & 26 & \simeq 2^{197} & \simeq 2^{9793}\\
\hline
2 & 13 & 994 & 659 & 7 & 14587 & 128 & 6 & \simeq 2^{45} & \simeq 2^{7386}\\
\hline
\end{array}
\end{equation*}
\caption{Suggested parameters for security 128, $m = 2$}
\end{table}

\newpage


\appendix


\section{Retrieving the equation of a cover: complexity analysis} \label{annexA}


In this section, we present a formal algorithm that describes the attack proposed in section~\ref{sectionkummer} in the special case of a Kummer covering of the projective line $\PP^1$. Recall that we are led to solve linear systems of the form :
\begin{equation} \tag{$\Delta(\xi)$}
\begin{pmatrix}
\mathbf{A}(\xi) \\
\mathbf{H} \cd \textbf{D}_1 \\
\vdots \\
\mathbf{H} \cd \textbf{D}_s
\end{pmatrix}
\cd \textbf{y}^T = 0,
\end{equation}
which consist in $s(n-k)+n$ equations and $n$ unknows, where $s=\dim(D)$ (see section 4 for the definition of the divisor $D$), $n$ and $k$ are respectively the lenght and dimension of the public SSAG code and $\xi \in \mu_{\ell}^*(\fqm)$. Suppose the function field $\fqm(x,y)$ of our Kummer curve is defined by
\[y^{\ell} = f(x),\]
with $f \in \fqm[T]$ and $d:=\deg(f)$ (note that $d$ is both the degree of the pole divisor of $f$ and its degree as a polynomial). In this framework, we describe in Algorithm 1 the attack of section~\ref{sectionkummer} to recover the polynomial $f$, as well as the secret structure of the public SSAG code.

\begin{algorithm} \label{algo1}
\SetAlgoVlined
\caption{Security reduction in Kummer case}
\SetKwInOut{Input}{Input} \SetKwInOut{Output}{Output} 
\Input{A parity check matrix $\mathbf{H}_{\mathrm{pub}}$ of the public code, the invariant support $\tilde{P}=\{P_1,\cdots,P_r\}$ and divisor $\tilde{G}$. Also we are given the quasi-cyclicity order $\ell > 0$ and the integer $d:=\deg(f)$.} 
\Output{The polynomial $f$ and the secret structure $(\PR,G)$.}
{
$x \longleftarrow (\underbrace{x(P_1),...,x(P_1)}_{\ell\mathrm{-fois}},...,x(P_r),...,x(P_r))$\\
$D \longleftarrow \tilde{G} - \lceil d/{\ell} \rceil \cd P_{\infty} \in \Div(\PP^1)$ \\
$s\longleftarrow \dim(D)$ \\
$M \longleftarrow$ set of primitive $\ell$-th roots of unity \\
cpt $:= 0$ \\
\While{$\mathrm{cpt} = 0$}{$\xi \xleftarrow[]{\$} M$ \\
	Exclude(M,$\xi$) \\
	$S \longleftarrow \mathrm{Solve}(\Delta(\xi))$ \\
	\If{$\dim(S)=1$}{cpt := 1 \\
		$y^* \xleftarrow[]{\$} S \backslash \{0\}$ \\
		$f \longleftarrow$ $\mathrm{Interpolate}(x,y^*)$ \\
		$\PR \longleftarrow \{P_{ij}=(x_{ij}:y_{ij}:1)\}$
	} 
} 
$G \longleftarrow \pi^*(\tilde{G})$ \\
\Return{$f$, $\PR \ \mathrm{and} \ G$}
}
\end{algorithm}

\begin{prop1} Let $n,k$ be the lenght and the dimension of the public $\ssag$-code respectively. Let $r := n/\ell$ be the number of orbits in $\PR$. If $r \geq d+1$, then Algorithm 1 finds an equation of the cover, as well as the secret structure of the public $\ssag$-code in $\calO(\varphi(\ell)(n^{\w}+n^{\w-1}s(n-k))$ operations over $\fqm$. 
\end{prop1}

\begin{proof} see \cite{CF} for details about complexity analysis. \\
The complexity of solving a linear system with $k$ equations and $n$ unknowns is in $\calO(n^{\w-1}k)$ operations over the base field, where $\w$ is the exponent of linear algebra. As a result, the cost of line 9 is $\calO(n^{\w}+n^{\w-1}s(n-k))$ operations over $\fqm$ (operations need to be done in $\fqm$ and not $\fq$ since the roots of unity might be in $\fqm \backslash \fq$). Since we have to seek for the correct root of unity $\xi$, this step might be repeated at most $\varphi(\ell)$-times, where $\varphi$ is the Euler totient function. Next, we have to realize one Lagrange's interpolation at line 13 in order to recover a defining equation of the Kummer cover. Let $d:=\deg(f)$ and note that at this step of the algorithm, we have recovered all the points in $\PR$, and thus if the number $r$ of orbits in $\PR$ is larger that $d+1$, Lagrange's interpolation finds a unique polynomial $f$ of degree $d$ such that a plane model of the cover is given by $y^{\ell}=f(x)$ in $\calO(d^2)$ operations over $\fqm$. Note that this step is negligible compared to the cost of line 9. Finally, the last step we have to care about is at line 15. In fact, at this stage of the algorithm, the whole cover is known and it remains to compute the pullback of the invariant divisor. As for the support, we need to recover the $y$-coordinates of points in $\Supp(G)$. This can be done by finding roots of several polynomials: indeed, from Kummer's theorem (see \cite{Sti}, Theore 3.3.7), if $x(Q)$ denotes the $x$-coordinate of a point $P \in \Supp(\tilde{G})$, then the $y$-coordinates of the extensions of $P$ in $\Supp(G)$ are exactly the roots of the polynomial $T^{\ell}-f(x(Q)) \in \fqm[T]$. This step can be done by factorizing each polynomial using Berlekamp algorithm, whose cost is $\calO(\ell^{\w}+q^m\ell^{2})$ operations over $\fqm$. In any practical cases, the lenght of the public code is larger that the cardinality of the base field (\textit{ie.} $n > q^m$) and thus this step is also negligible. As a result, the total cost of Algorithm 1 is in $\calO(\varphi(\ell)(n^{\w}+n^{\w-1}s(n-k))$ over $\fqm$.
\end{proof}

Note that Algorithm 1 can also be used in the case of an Artin-Schreier cover of $\PP^1$, by only changing a few lines. In fact, in the latter setup, we have to solve at most $p = \#(\mathbb{F}_p)$ linear system of the form~\eqref{a-s system}, whose total cost is in $\calO(p(n^{\w}+n^{\w-1}s(n-k))$ operations over $\fqm$.

\begin{rq1}
In Algorithm 1, we describe our attack in the special case were the quotient curve is the projective line $\PP^1$, as it is easier to produce a complexity analysis. However, it can be generalized to any Kummer or Artin-Schreier cover, the only difference being the interpolation step at the end. In fact, in the more general case, the polynomial we have to recover is bivariate, thus the interpolation step might be harder. More precisly, we can use a bivariate Lagrange's interpolation that requires more evaluation points, \textit{ie.} at least $\binom{d^*+2}{d^*}$ of them, where $d^*$ is the degree of $f$ as a bivariate polynomial. Another point that could be problematic is that the corresponding system might have more than one solution.
This is the main counterpart of considering polynomials instead of rational functions. We could actually use interpolation techniques in the function field of a curve insted of using it on polynomials, but this theory is not well-developed yet, which is the reason why we only work with polynomials.
\end{rq1}

\begin{rq1}
In section~\ref{solvable}, we generalized our attack in the case of a solvable Galois covering, by applying several times the Kummer or Artin-Schreier case. The total cost of the attack in this context corresponds to the number of iterations we have to use Algorithm 1. In particular, if our solvable Galois group has order $p^s\lambda$, with $p=\mathrm{char}(\fqm)$ and $(p,\lambda)=1$, the attack consists in $s+1$-iterations of Algorithm 1. Do not forget that this is possible if and only if the conditions on primitives roots of unity is satisfied. If not, it is possible to extend the base field, say $\mathbb{F}_{q^m} \supseteq \fqm$. Doing so, so complexity of the algorithm is increased since we now have to compte in a bigger field.
\end{rq1}

\newpage

\section{Brute force Algorithm on the invariant code}


In section~\ref{bruteforce}, we described a brute force attack against SSAG codes, which is detailled in Algorithm 2 below. As for the notations, we consider an SSAG code of length $n$ defined over a curve $\X$, associated to a degree $r \geq 0$ divisor. We denote by $\Cl^r(\X)$ the group of divisor class of degree $r$ in $\X$, and for $G \in \Div(\X)$, $[G]$ represents its class in $\Cl^r(\X)$. The idea is to recover the good permutation amoung all subsets of lenght $n$, and then use the SSA algorithm (see \cite{SSA}). The divisor is searched amoung all classes of divisor of the given degree, using \eqref{nb of sssag}.

\begin{algorithm}\label{algo:brute_force_SSAG}
\SetAlgoVlined
\caption{Brute force on SSAG}
\SetKwInOut{Input}{Input} \SetKwInOut{Output}{Output} 
\Input{A generator matrix $\mathbf{G}$ of the invariant SSAG code $\C$ and an integer $r$ which refers to the degree of the divisor.}
\Output{The support $\PR$ and the divisor $G$ such that 
$\C = \mathrm{SSAG}_q(\X,\PR,G)$.}
{
$S \leftarrow \{P \in \X ~|~ \mathrm{deg}(P)=1\}$ \eolcomment{The order of $S$ is fixed}\\
\For{$[G] \in \Cl^r(\X)$}{
    $\C' \leftarrow  \mathrm{SSAG}_q(\X,S,G) $ \eolcomment{$G$ will be a representative of $[G]$}\\
    \For{$[\mathbf{w}] \in \fqm^n/\mathbb{F}_q^n$ }{\inlcomment{$\mathbf{w}$ will be a representative of $[\mathbf{w}]$}\\
        \For{$\mathcal{I} \subseteq \{1,\dots,N(\X)-1\} \ \mathrm{with} \ |\mathcal{I}| = n$}{
            $\C_{\mathcal{I}}' \leftarrow \text{Punct}_{\mathcal{I}}(\C')$\\
            $\pi \leftarrow$ SSA($\mathbf{w} \star \C_{\mathcal{I}}',\C$) \eolcomment{SSA return a permutation $\pi$ or `?'}\\
            \If{$\pi \in \mathfrak{S}_n$}{
                $S_I \leftarrow \{P_i \in S \mid i \in \mathcal{I}\}$\\
                \Return{$\pi(S_{\mathcal{I}}), G \ \mathrm{and} \ \mathbf{w}$}
            }
        }
    }
}
}
\end{algorithm}

As it is complicated to provide a complexity analysis for the support recovering, we can at least say that the complexity of Algorithm 2 is at least the cost of the exhaustive search on $G$ and $\mathbf{w}$. For our proposal on the Hermitian curve and using  \eqref{nb of sssag}, the algorithm requires at least
\[ ((q^m-1)^{n-1}-(q-1)^{n-1})h(\mathcal{H}/\langle \sigma \rangle) \ \mathrm{operations  \ over} \ \fq.\]
By Theorem~\ref{esti h(X)}, we know that 
\[(\sqrt{q^m}-1)^{2g(\mathcal{H}/\langle \sigma \rangle)} \leq h(\mathcal{H}/\langle \sigma \rangle) \leq (\sqrt{q^m}-1)^{2g(\mathcal{H}/\langle \sigma \rangle)},\] 
which leads to $h(\mathcal{H}/\langle \sigma \rangle) \in \mathcal{O}(q^{mg(\mathcal{H}/\langle \sigma \rangle)})$. As a result, the cost of the enumeration of divisors $G$ in $\Cl^r(\mathcal{H}/\langle \sigma \rangle)$ and vectors in $\fqm/\fq$ is in $\mathcal{O}(q^{m(n-1)+mg(\mathcal{H}/\langle \sigma \rangle)})$ operations over $\fq$. \\
\noindent Finally, Proposition~\ref{genus} and Corollary~\ref{lastcorollary} allow us to choose the paramerters (see section~\ref{some parameters}) in order $h(\calH/\langle \sigma \rangle)$ to be high enough to block the brute force attack.


\newpage
\bibliographystyle{alpha}
\bibliography{bib}
\end{document}
